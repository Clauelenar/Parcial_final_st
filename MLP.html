
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MODELO MLP &#8212; Parcial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MLP';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MODELO RNN" href="RNN.html" />
    <link rel="prev" title="Modelos estadísticos" href="Ejercicio2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Parcial</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial Series de tiempo
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio1.html">Parcial 1 de Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ejercicio2.html">Modelos estadísticos</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">MODELO MLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="RNN.html">MODELO RNN</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MLP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MODELO MLP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelo-mlp">
<h1>MODELO MLP<a class="headerlink" href="#modelo-mlp" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">py</span>
</pre></div>
</div>
</div>
</div>
<section id="datos">
<h2>Datos<a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\claud\Downloads\Bitcoin Historical Data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Vol.</th>
      <th>Change %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03/24/2024</td>
      <td>67,211.9</td>
      <td>64,036.5</td>
      <td>67,587.8</td>
      <td>63,812.9</td>
      <td>65.59K</td>
      <td>4.96%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03/23/2024</td>
      <td>64,037.8</td>
      <td>63,785.6</td>
      <td>65,972.4</td>
      <td>63,074.9</td>
      <td>35.11K</td>
      <td>0.40%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03/22/2024</td>
      <td>63,785.5</td>
      <td>65,501.5</td>
      <td>66,633.3</td>
      <td>62,328.3</td>
      <td>72.43K</td>
      <td>-2.62%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03/21/2024</td>
      <td>65,503.8</td>
      <td>67,860.0</td>
      <td>68,161.7</td>
      <td>64,616.1</td>
      <td>75.26K</td>
      <td>-3.46%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03/20/2024</td>
      <td>67,854.0</td>
      <td>62,046.8</td>
      <td>68,029.5</td>
      <td>60,850.9</td>
      <td>133.53K</td>
      <td>9.35%</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4994</th>
      <td>07/22/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>2.16K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4995</th>
      <td>07/21/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.58K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>07/20/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.26K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>07/19/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.57K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>07/18/2010</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.08K</td>
      <td>0.00%</td>
    </tr>
  </tbody>
</table>
<p>4999 rows × 7 columns</p>
</div></div></div>
</div>
<p>Para que los datos estén en el formato correcto se les aplicará el siguiente proceso de eliminación de formatos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar comas y convertir las columnas relevantes a float</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="c1"># Función para convertir valores con &#39;K&#39;, &#39;M&#39;, &#39;B&#39; o números directos</span>
<span class="k">def</span> <span class="nf">convert_volume</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="c1"># Verificar si el valor ya es numérico</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>  <span class="c1"># Devolver el valor si ya es numérico</span>
    <span class="k">elif</span> <span class="s1">&#39;K&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000</span>
    <span class="k">elif</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000</span>
    <span class="k">elif</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000_000</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="c1"># Aplicar la función a la columna &#39;Vol.&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_volume</span><span class="p">)</span>

<span class="c1"># Verificar que la conversión haya sido exitosa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Vol.
0   65590.0
1   35110.0
2   72430.0
3   75260.0
4  133530.0
</pre></div>
</div>
</div>
</div>
<p>Se verifica el formato de la fecha y se agrega la columnna indice</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegurarse de que la columna &quot;Date&quot; sea de tipo datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span>
<span class="c1"># Ordenar los datos por fecha de forma ascendente</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Verificar si hay valores nulos en cada columna</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="c1"># Alternativa: Mostrar las filas que contengan valores faltantes</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filas con datos faltantes:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Asegúrate de que la columna &#39;Date&#39; esté en formato datetime</span>

<span class="c1"># Convertir la fecha a un timestamp (número de días desde Epoch)</span>

<span class="c1"># Ver las primeras filas con la nueva columna numérica</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;indice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date        0
Price       0
Open        0
High        0
Low         0
Vol.        6
Change %    0
dtype: int64
Filas con datos faltantes:
          Date  Price  Open  High   Low  Vol. Change %
337 2011-06-20   17.5  17.5  17.5  17.5   NaN    0.00%
338 2011-06-21   17.5  17.5  17.5  17.5   NaN    0.00%
339 2011-06-22   17.5  17.5  17.5  17.5   NaN    0.00%
340 2011-06-23   17.5  17.5  17.5  17.5   NaN    0.00%
341 2011-06-24   17.5  17.5  17.5  17.5   NaN    0.00%
342 2011-06-25   17.5  17.5  17.5  17.5   NaN    0.00%
</pre></div>
</div>
</div>
</div>
</section>
<section id="funciones">
<h2>Funciones<a class="headerlink" href="#funciones" title="Link to this heading">#</a></h2>
<section id="ventanas-deslizantes">
<h3>Ventanas deslizantes<a class="headerlink" href="#ventanas-deslizantes" title="Link to this heading">#</a></h3>
<p>Para esto creamos una función que divide los datos en entrenamiento, validación y prueba. Esta función avanca con un paso de 1. las ventanas y el horizonte de predicción son variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">create_sliding_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1"># Generar ventanas deslizantes con sus índices correspondientes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Entrenamiento</span>
        <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
        <span class="n">Y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Validación</span>
        <span class="n">X_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Prueba</span>
        <span class="n">X_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

    <span class="c1"># Convertir a arrays de NumPy</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># (n_samples, window_size)</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">Y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>  <span class="c1"># (n_samples, horizon)</span>
    <span class="n">Y_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_val</span><span class="p">)</span>
    <span class="n">Y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>

    <span class="c1"># Asegurarse de que los datos están en la forma adecuada para MLP (n_samples, n_features)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>  <span class="c1"># Eliminar dimensión extra</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo">
<h3>Construcción del Modelo<a class="headerlink" href="#construccion-del-modelo" title="Link to this heading">#</a></h3>
<p>Creamos una función para crear el modelo teniendo en cuenta los parametros de las iteraciones neurons, window, dropout_rate, horizon. Batch size se aplicará más adelante</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Input</span>

<span class="k">def</span> <span class="nf">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">window</span><span class="p">,)))</span> 
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">horizon</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">q_stat</span><span class="p">,</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metricas">
<h3>Métricas<a class="headerlink" href="#metricas" title="Link to this heading">#</a></h3>
<p>Creamos una función que calcule las metricas importantes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">metricas</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    
    <span class="c1"># Calcular métricas en Validación</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Advertencia: Las predicciones contienen NaN.&quot;</span><span class="p">)</span>
        <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">windows</span> <span class="o">-</span> <span class="n">pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">windows</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>

        
        <span class="c1"># Guardar métricas del conjunto de validación junto con pruebas de hipótesis</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
            <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
            <span class="s1">&#39;Dropout&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
            <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
            <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span><span class="p">,</span> <span class="n">q_stat</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="funcion-de-optimizacion">
<h3>Función de optimización<a class="headerlink" href="#funcion-de-optimizacion" title="Link to this heading">#</a></h3>
<p>se creo una función con la cual se itera entre todas las posibles combinaciones de paramtros. Se tiene en cuenta el early stoping y la estabilización de la metrica mse para encontar el mejor modelo. luego de que el mse no varie más del 5% 5 iteraciones seguidas se detiene. Además se guardan los residuos y metricas de cada modelo para su posterior uso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">busqueda</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">windows</span><span class="p">,</span> <span class="n">horizons</span><span class="p">,</span> <span class="n">dropout_rates</span><span class="p">,</span> <span class="n">batchsizes</span><span class="p">,</span> <span class="n">neurons_list</span><span class="p">):</span>
    <span class="n">validation_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">train_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">residual_hist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">best_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> 
    <span class="n">previous_mse</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Para rastrear el MSE de la iteración anterior</span>
    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Contador para rastrear iteraciones estables</span>

    <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">neurons</span> <span class="ow">in</span> <span class="n">neurons_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">horizon</span> <span class="ow">in</span> <span class="n">horizons</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="n">horizon</span><span class="p">:</span>
                    <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_sliding_windows</span><span class="p">(</span>
                        <span class="n">datos</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">dropout_rate</span> <span class="ow">in</span> <span class="n">dropout_rates</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">batchsize</span> <span class="ow">in</span> <span class="n">batchsizes</span><span class="p">:</span>

                            <span class="c1"># Crear y entrenar el modelo</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entrenando modelo con </span><span class="si">{</span><span class="n">neurons</span><span class="si">}</span><span class="s2"> neuronas, dropout </span><span class="si">{</span><span class="n">dropout_rate</span><span class="si">}</span><span class="s2">, &quot;</span>
                                  <span class="sa">f</span><span class="s2">&quot;batch size </span><span class="si">{</span><span class="n">batchsize</span><span class="si">}</span><span class="s2">, horizon </span><span class="si">{</span><span class="n">horizon</span><span class="si">}</span><span class="s2">, window </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">model</span> <span class="o">=</span> <span class="n">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>

                            <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
                                <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                            <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                                <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
                                <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">],</span>
                                <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span>
                            <span class="p">)</span>

                            <span class="c1"># Predicciones y cálculo de residuos</span>
                            <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
                            <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
                            <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>

                            <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_val</span> <span class="o">-</span> <span class="n">val_pred</span>  <span class="c1"># Residuos de validación</span>
                            <span class="n">residual_hist</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                                <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                <span class="s1">&#39;residuals&#39;</span><span class="p">:</span> <span class="n">residuals</span>
                            <span class="p">})</span>

                            <span class="c1"># Calcular métricas en validación</span>
                            
                            <span class="n">metricas_val</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">val_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">validation_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_val</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en prueba</span>
                            <span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">test_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en entrenamiento</span>
                            <span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">train_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">metricas_val</span><span class="p">:</span>
                                <span class="n">mse</span> <span class="o">=</span> <span class="n">metricas_val</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="c1"># Verificar la fluctuación del MSE</span>
                                <span class="k">if</span> <span class="n">previous_mse</span><span class="p">:</span>
                                    <span class="n">variation</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mse</span> <span class="o">-</span> <span class="n">previous_mse</span><span class="p">)</span> <span class="o">/</span> <span class="n">previous_mse</span>
                                    <span class="k">if</span> <span class="n">variation</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">+=</span> <span class="mi">1</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fluctuación menor al 5% en el MSE por </span><span class="si">{</span><span class="n">stable_iterations</span><span class="si">}</span><span class="s2"> iteración(es).&quot;</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Reiniciar contador si hay variación mayor al 5%</span>

                                    <span class="k">if</span> <span class="n">stable_iterations</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fluctuación menor al 5</span><span class="si">% d</span><span class="s2">urante 5 iteraciones consecutivas. Deteniendo la búsqueda.&quot;</span><span class="p">)</span>
                                        <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> 
                                                <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>

                                <span class="n">previous_mse</span> <span class="o">=</span> <span class="n">mse</span>

                                <span class="c1"># Guardar el mejor modelo si es necesario</span>
                                <span class="k">if</span> <span class="n">mse</span> <span class="o">&lt;</span> <span class="n">best_score</span><span class="p">:</span>
                                    <span class="n">best_score</span> <span class="o">=</span> <span class="n">mse</span>
                                    <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
                                    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                        <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                        <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                        <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                        <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span>
                                    <span class="p">}</span>
                                    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="n">residuals</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="serie-price">
<h2>Serie Price<a class="headerlink" href="#serie-price" title="Link to this heading">#</a></h2>
<p>Utilización de las funciones para encontrar los mejores parametros para la serie de tiempo <code class="docutils literal notranslate"><span class="pre">Price</span></code></p>
<section id="modelo">
<h3>Modelo<a class="headerlink" href="#modelo" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>


<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="n">validation_metrics_price</span><span class="p">,</span><span class="n">test_metrics_price</span><span class="p">,</span><span class="n">train_metrics_price</span><span class="p">,</span><span class="n">residual_hist_price</span><span class="p">,</span><span class="n">best_model_price</span><span class="p">,</span><span class="n">params_best_model_price</span><span class="p">,</span><span class="n">residuals_bestmodel_price</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 11s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 95/156 [=================&gt;............] - ETA: 0s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 516us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 98/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 539us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 53/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
103/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
143/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 51202574.23108936
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 5s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/156 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 96/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 50/156 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 91/156 [================&gt;.............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
131/156 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 59/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
101/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
151/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 158618743.08371416
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 43/156 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 90/156 [================&gt;.............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 94/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 643us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 56/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 99/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
140/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 105555193.55146627
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 74/156 [=============&gt;................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 932us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 49/156 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 97/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
148/156 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 70/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
117/156 [=====================&gt;........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 893us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 301016196.14561623
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 58/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
115/156 [=====================&gt;........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 998us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/156 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
101/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
150/156 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
143/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 709us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 75491405.62222937
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 6s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 70/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
112/156 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 880us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 46/156 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 99/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
139/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 40/156 [======&gt;.......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 75/156 [=============&gt;................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
142/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 334812359.72731066
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 5s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 53/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/156 [===============&gt;..............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
119/156 [=====================&gt;........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
152/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 76/156 [=============&gt;................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
141/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 741us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 55/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 924us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 207387054.01076865
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 62/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
118/156 [=====================&gt;........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 846us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 62/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
124/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 823us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 56/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
139/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 768us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 473425914.19462645
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 70/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
152/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 69/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
114/156 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 904us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 72/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
143/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 733us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 109188285.72823778
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 53/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 96/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
136/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 51/156 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 96/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
132/156 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 99/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
140/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 228767877.5173626
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 79/156 [==============&gt;...............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
121/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 935us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
111/156 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
148/156 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 34/156 [=====&gt;........................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 72/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
104/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
142/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 399798649.525063
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 74/156 [=============&gt;................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
127/156 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 901us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 69/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 832us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
124/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 848us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 548363964.1619259
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 62/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
106/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
142/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 70/156 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
110/156 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
153/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 61/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
106/156 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
144/156 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 168667078.62011638
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 64/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
126/156 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 788us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 49/156 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 97/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
137/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 55/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 91/156 [================&gt;.............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
139/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 174648252.92546788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 67/156 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
112/156 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
152/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 73/156 [=============&gt;................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
131/156 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 859us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 58/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 97/156 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
138/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 434142231.5168694
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 61/156 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
103/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
136/156 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 57/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
100/156 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
153/156 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/156 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 57/156 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 89/156 [================&gt;.............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/156 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
156/156 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 363633889.9808945
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 60/155 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
119/155 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 872us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 61/155 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
101/155 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
149/155 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 48/155 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 93/155 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
140/155 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 51906620.840924814
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 64/155 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
139/155 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 717us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/155 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
103/155 [==================&gt;...........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 966us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 59/155 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
111/155 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 913us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 103975596.45267968
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 5s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 46/155 [=======&gt;......................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 83/155 [===============&gt;..............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
126/155 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 53/155 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 95/155 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
141/155 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 68/155 [============&gt;.................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/155 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 823us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 43981946.705258526
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 54/155 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
106/155 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
143/155 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 56/155 [=========&gt;....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 91/155 [================&gt;.............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
127/155 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 64/155 [===========&gt;..................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
120/155 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 895us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 332674058.3107379
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 79/155 [==============&gt;...............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
143/155 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 747us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 48/155 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
110/155 [====================&gt;.........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 886us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/155 [..............................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 51/155 [========&gt;.....................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 84/155 [===============&gt;..............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
119/155 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/155 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 93862577.5828953
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="n">validation_metrics_price</span><span class="p">,</span><span class="n">test_metrics_price</span><span class="p">,</span><span class="n">train_metrics_price</span><span class="p">,</span><span class="n">residual_hist_price</span><span class="p">,</span><span class="n">best_model_price</span><span class="p">,</span><span class="n">params_best_model_price</span><span class="p">,</span><span class="n">residuals_bestmodel_price</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>

<span class="nn">Cell In[10], line 47,</span> in <span class="ni">busqueda</span><span class="nt">(datos, windows, horizons, dropout_rates, batchsizes, neurons_list)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span> <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="c1"># Predicciones y cálculo de residuos</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span> <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\keras\utils\traceback_utils.py:65,</span> in <span class="ni">filter_traceback.&lt;locals&gt;.error_handler</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="n">filtered_tb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">65</span>     <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span>     <span class="n">filtered_tb</span> <span class="o">=</span> <span class="n">_process_traceback_frames</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">__traceback__</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\keras\engine\training.py:2220,</span> in <span class="ni">Model.predict</span><span class="nt">(self, x, batch_size, verbose, steps, callbacks, max_queue_size, workers, use_multiprocessing)</span>
<span class="g g-Whitespace">   </span><span class="mi">2211</span>     <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2212</span>         <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2213</span>             <span class="s2">&quot;Using Model.predict with MultiWorkerMirroredStrategy &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2214</span>             <span class="s2">&quot;or TPUStrategy and AutoShardPolicy.FILE might lead to &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2217</span>             <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2218</span>         <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2220</span> <span class="n">data_handler</span> <span class="o">=</span> <span class="n">data_adapter</span><span class="o">.</span><span class="n">get_data_handler</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2221</span>     <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2222</span>     <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2223</span>     <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2224</span>     <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2225</span>     <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2226</span>     <span class="n">max_queue_size</span><span class="o">=</span><span class="n">max_queue_size</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2227</span>     <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2228</span>     <span class="n">use_multiprocessing</span><span class="o">=</span><span class="n">use_multiprocessing</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2229</span>     <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2230</span>     <span class="n">steps_per_execution</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_steps_per_execution</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2231</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2233</span> <span class="c1"># Container that configures and calls `tf.keras.Callback`s.</span>
<span class="g g-Whitespace">   </span><span class="mi">2234</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">callbacks_module</span><span class="o">.</span><span class="n">CallbackList</span><span class="p">):</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\keras\engine\data_adapter.py:1582,</span> in <span class="ni">get_data_handler</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1580</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">],</span> <span class="s2">&quot;_cluster_coordinator&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1581</span>     <span class="k">return</span> <span class="n">_ClusterCoordinatorDataHandler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1582</span> <span class="k">return</span> <span class="n">DataHandler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\keras\engine\data_adapter.py:1262,</span> in <span class="ni">DataHandler.__init__</span><span class="nt">(self, x, y, sample_weight, batch_size, steps_per_epoch, initial_epoch, epochs, shuffle, class_weight, max_queue_size, workers, use_multiprocessing, model, steps_per_execution, distribute)</span>
<span class="g g-Whitespace">   </span><span class="mi">1259</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_steps_per_execution</span> <span class="o">=</span> <span class="n">steps_per_execution</span>
<span class="g g-Whitespace">   </span><span class="mi">1261</span> <span class="n">adapter_cls</span> <span class="o">=</span> <span class="n">select_data_adapter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1262</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span> <span class="o">=</span> <span class="n">adapter_cls</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1263</span>     <span class="n">x</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1264</span>     <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1265</span>     <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1266</span>     <span class="n">steps</span><span class="o">=</span><span class="n">steps_per_epoch</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1267</span>     <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span> <span class="o">-</span> <span class="n">initial_epoch</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1268</span>     <span class="n">sample_weights</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1269</span>     <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1270</span>     <span class="n">max_queue_size</span><span class="o">=</span><span class="n">max_queue_size</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1271</span>     <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1272</span>     <span class="n">use_multiprocessing</span><span class="o">=</span><span class="n">use_multiprocessing</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1273</span>     <span class="n">distribution_strategy</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">get_strategy</span><span class="p">(),</span>
<span class="g g-Whitespace">   </span><span class="mi">1274</span>     <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1275</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1277</span> <span class="n">strategy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">get_strategy</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1279</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_step</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\keras\engine\data_adapter.py:290,</span> in <span class="ni">TensorLikeDataAdapter.__init__</span><span class="nt">(self, x, y, sample_weights, sample_weight_modes, batch_size, epochs, steps, shuffle, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> <span class="c1"># Vectorized version of shuffle.</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span> <span class="c1"># This is a performance improvement over using `from_tensor_slices`.</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span> <span class="c1"># The indices of the data are shuffled and batched, and these indices</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span> <span class="c1"># 4. optimized permutation batching</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span> <span class="c1"># 5. disabled static optimizations</span>
<span class="ne">--&gt; </span><span class="mi">290</span> <span class="n">indices_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span> <span class="k">if</span> <span class="n">shuffle</span> <span class="o">!=</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span>     <span class="n">indices_dataset</span> <span class="o">=</span> <span class="n">indices_dataset</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:1216,</span> in <span class="ni">DatasetV2.range</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1180</span> <span class="nd">@staticmethod</span>
<span class="g g-Whitespace">   </span><span class="mi">1181</span> <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1182</span><span class="w">   </span><span class="sd">&quot;&quot;&quot;Creates a `Dataset` of a step-separated range of values.</span>
<span class="g g-Whitespace">   </span><span class="mi">1183</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span><span class="sd">   &gt;&gt;&gt; list(Dataset.range(5).as_numpy_iterator())</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1214</span><span class="sd">     ValueError: if len(args) == 0.</span>
<span class="g g-Whitespace">   </span><span class="mi">1215</span><span class="sd">   &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1216</span>   <span class="k">return</span> <span class="n">RangeDataset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:4934,</span> in <span class="ni">RangeDataset.__init__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">4932</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4933</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="n">tensor_spec</span><span class="o">.</span><span class="n">TensorSpec</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_type</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">4934</span> <span class="n">variant_tensor</span> <span class="o">=</span> <span class="n">gen_dataset_ops</span><span class="o">.</span><span class="n">range_dataset</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4935</span>     <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4936</span>     <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4937</span>     <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4938</span>     <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_common_args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4939</span> <span class="nb">super</span><span class="p">(</span><span class="n">RangeDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">variant_tensor</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\ml_venv\lib\site-packages\tensorflow\python\ops\gen_dataset_ops.py:6286,</span> in <span class="ni">range_dataset</span><span class="nt">(start, stop, step, output_types, output_shapes, metadata, replicate_on_split, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">6284</span> <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6285</span>   <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">6286</span>     <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">6287</span>       <span class="n">_ctx</span><span class="p">,</span> <span class="s2">&quot;RangeDataset&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="s2">&quot;output_types&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">6288</span>       <span class="n">output_types</span><span class="p">,</span> <span class="s2">&quot;output_shapes&quot;</span><span class="p">,</span> <span class="n">output_shapes</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">6289</span>       <span class="s2">&quot;replicate_on_split&quot;</span><span class="p">,</span> <span class="n">replicate_on_split</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6290</span>     <span class="k">return</span> <span class="n">_result</span>
<span class="g g-Whitespace">   </span><span class="mi">6291</span>   <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_price</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 1000, &#39;batchsize&#39;: 16, &#39;dropout_rate&#39;: 0.4, &#39;horizon&#39;: 7, &#39;window&#39;: 7, &#39;MSE&#39;: 2603412.7151821335}
</pre></div>
</div>
</div>
</div>
<p>A diferencia de las RNN redes neuronales recurrentes el modelo mpl es rápido por que permite hacer la optimización con todos los posibles parametros. los mejores resultados fueron con la combinación {‘neurons’: 10000, ‘batchsize’: 32, ‘dropout_rate’: 0.4, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 2633246.2263151007}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="residuales">
<h3>Residuales<a class="headerlink" href="#residuales" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo para su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_price</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.175408
1        2             0.175408
2        3             0.175408
3        4             0.175408
4        5             0.175408
5        6             0.175408
6        7             0.175408
7        8             0.175408
8        9             0.175408
9       10             0.175408
</pre></div>
</div>
<img alt="_images/42e9fcecd3f7cafaf2456d53f529c1dba75d58e0c6861e090d18c0201256fa80.png" src="_images/42e9fcecd3f7cafaf2456d53f529c1dba75d58e0c6861e090d18c0201256fa80.png" />
<img alt="_images/e49b9d7539f1c390fd93315e48b1b2dc93bbb2450601906bc430b340114b3f55.png" src="_images/e49b9d7539f1c390fd93315e48b1b2dc93bbb2450601906bc430b340114b3f55.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_24512\1560686776.py:34: MatplotlibDeprecationWarning:

The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
</pre></div>
</div>
<img alt="_images/52c721344e3656a7f7ab88f7520a32e9ee18b20b9f9c2f32d2d20094839c97cc.png" src="_images/52c721344e3656a7f7ab88f7520a32e9ee18b20b9f9c2f32d2d20094839c97cc.png" />
<img alt="_images/6042af00878109bbe99231a758d785b94a4a212812984a431b39d24fb893b1a5.png" src="_images/6042af00878109bbe99231a758d785b94a4a212812984a431b39d24fb893b1a5.png" />
<img alt="_images/dd8745f2ed282896c0bcaf0ff19811be560ba4994213f0fd48eae273d1dec28b.png" src="_images/dd8745f2ed282896c0bcaf0ff19811be560ba4994213f0fd48eae273d1dec28b.png" />
<img alt="_images/300e4710e3779c2f9a6db09b0b42611cbc9a62318b0117113b0f805b06c7701d.png" src="_images/300e4710e3779c2f9a6db09b0b42611cbc9a62318b0117113b0f805b06c7701d.png" />
<img alt="_images/2c89ab6b6a1f083ab64b7dae73ca14ae1290bf52eb8b79f36465efc93b1bc0ad.png" src="_images/2c89ab6b6a1f083ab64b7dae73ca14ae1290bf52eb8b79f36465efc93b1bc0ad.png" />
<img alt="_images/236e9d65d3b1d15cb37570dd008c5eb33ebe794dbdf014027b112599c5774bc6.png" src="_images/236e9d65d3b1d15cb37570dd008c5eb33ebe794dbdf014027b112599c5774bc6.png" />
<img alt="_images/a6d6a7bfe6733c033056a6a1713514c41deb21108804e92a2bd7f23b0fd6d1e4.png" src="_images/a6d6a7bfe6733c033056a6a1713514c41deb21108804e92a2bd7f23b0fd6d1e4.png" />
<img alt="_images/2349895acf17355ebfd8a39460418c6002de3c7420188d73752ef8ac9fbcdf17.png" src="_images/2349895acf17355ebfd8a39460418c6002de3c7420188d73752ef8ac9fbcdf17.png" />
<img alt="_images/cb8f14dc9589083e3ee13605d6da9aae7acccd7e664e8f781cd09a281524bb28.png" src="_images/cb8f14dc9589083e3ee13605d6da9aae7acccd7e664e8f781cd09a281524bb28.png" />
<img alt="_images/e13a7eca77d3e1ddb92c5721b31174a113df9faf2b13056fc3bb3ec127651cfe.png" src="_images/e13a7eca77d3e1ddb92c5721b31174a113df9faf2b13056fc3bb3ec127651cfe.png" />
<img alt="_images/b65e01cbc3f0922e47506a94b9e9a10c4ee7d1172c861010328bfe5b0a12bbb2.png" src="_images/b65e01cbc3f0922e47506a94b9e9a10c4ee7d1172c861010328bfe5b0a12bbb2.png" />
<img alt="_images/0e0b8e95e7756ffa04c1ec4a40360d51974f24c32cd5b5372852683d9a8534f1.png" src="_images/0e0b8e95e7756ffa04c1ec4a40360d51974f24c32cd5b5372852683d9a8534f1.png" />
<img alt="_images/b36e901c5fb07986b363a6b3ec3caf0944c37ba05c3b8ff436e84e7d9c53b035.png" src="_images/b36e901c5fb07986b363a6b3ec3caf0944c37ba05c3b8ff436e84e7d9c53b035.png" />
</div>
</div>
<p>De los residuales podemos secir que no cumplen cumplen, no distribuyen normal, tienen asimetria, además no son independientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_price</span>  <span class="c1"># Lista que contiene los diccionarios</span>
<span class="n">metrics</span><span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neurons</th>
      <th>batchsize</th>
      <th>Dropout</th>
      <th>horizon</th>
      <th>window</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>16</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>42.100560</td>
      <td>4147.057977</td>
      <td>1.108419e+08</td>
      <td>10528.146659</td>
      <td>0.553227</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>32</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>22.971461</td>
      <td>2178.980991</td>
      <td>2.174831e+07</td>
      <td>4663.507861</td>
      <td>0.912276</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>64</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>81.524718</td>
      <td>8925.020610</td>
      <td>2.649783e+08</td>
      <td>16278.153464</td>
      <td>-0.072416</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>128</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>87.749502</td>
      <td>9543.498107</td>
      <td>3.113885e+08</td>
      <td>17646.203853</td>
      <td>-0.261719</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>16</td>
      <td>0.4</td>
      <td>7</td>
      <td>7</td>
      <td>24.633035</td>
      <td>2218.578307</td>
      <td>1.911598e+07</td>
      <td>4372.183087</td>
      <td>0.922584</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>10000</td>
      <td>128</td>
      <td>0.6</td>
      <td>28</td>
      <td>28</td>
      <td>19.087526</td>
      <td>1693.555328</td>
      <td>1.338477e+07</td>
      <td>3658.520199</td>
      <td>0.943160</td>
    </tr>
    <tr>
      <th>252</th>
      <td>10000</td>
      <td>16</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>19.419760</td>
      <td>1524.443347</td>
      <td>1.107888e+07</td>
      <td>3328.494546</td>
      <td>0.952960</td>
    </tr>
    <tr>
      <th>253</th>
      <td>10000</td>
      <td>32</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>16.669882</td>
      <td>1345.119313</td>
      <td>9.245318e+06</td>
      <td>3040.611504</td>
      <td>0.960794</td>
    </tr>
    <tr>
      <th>254</th>
      <td>10000</td>
      <td>64</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>18.618648</td>
      <td>1526.831273</td>
      <td>1.124355e+07</td>
      <td>3353.139941</td>
      <td>0.952270</td>
    </tr>
    <tr>
      <th>255</th>
      <td>10000</td>
      <td>128</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>18.535917</td>
      <td>1623.494131</td>
      <td>1.245687e+07</td>
      <td>3529.428474</td>
      <td>0.947110</td>
    </tr>
  </tbody>
</table>
<p>256 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En esta figura podemos observar el MSE a lo largo de las iteraciones, vemos que a medida que se aumnetaron las neuronas el resultado mejoraba. Además delemitar la busqueda a partir de los parametros que ya se sabía que tenian buen desempeño permitió estabilizar la metrica.</p>
</section>
<section id="boxplot">
<h4>Boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h4>
<p>Ahora compararemos los errores en el entrenamiento, prueba y test con la metrica mape porque esta representa los errores de manera porcentual</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_price</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_price</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
        
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre 3 Listas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4b8be0ea025570c414de065718d30e3f38a8c3158604e9630194421c7070ac60.png" src="_images/4b8be0ea025570c414de065718d30e3f38a8c3158604e9630194421c7070ac60.png" />
</div>
</div>
<p>Las medianas son similares al igual que los las cajas porque al manejar la metodología de ventanas deslizantes los conjuntos son iguales a excepción de la primera y ultima ventana. sin embargo las medianas se van reduciendo porque el modelo aprende luego de evaluar el conjunto de validación, reajuste del modelo.</p>
<p>Los puntos por fuera de las cajas implican que el modelo suavizó picos o fluctuaciones atípicas</p>
</section>
</section>
<section id="prediciones">
<h3>Prediciones<a class="headerlink" href="#prediciones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_price</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 0s 663us/step
156/156 [==============================] - 0s 605us/step
156/156 [==============================] - 0s 714us/step
</pre></div>
</div>
</div>
</div>
<p>Aquí podemos ver la predicción de las ventanas para entrenamiento de manera independiente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En la grafica se puede los horizones de predicción para cada ventana. el conjunto de train es igual al de validación sin embargo la prueba se mantiene con diferencia</p>
</section>
</section>
<section id="serie-change">
<h2>Serie Change%<a class="headerlink" href="#serie-change" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Crear el objeto escalador</span>

<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Change %&#39;</span><span class="p">]</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Escala los datos</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
<span class="n">datos</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4999,)
</pre></div>
</div>
</div>
</div>
<p>Para esta serie se hizo una modificación especial, no solo se esscalaron los datos sino que se les sumó 1 para evitar tener errores por valores en 0, a la hora de calcular las métricas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

<span class="n">validation_metrics_ch</span><span class="p">,</span><span class="n">test_metrics_ch</span><span class="p">,</span><span class="n">train_metrics_ch</span><span class="p">,</span><span class="n">residual_hist_ch</span><span class="p">,</span><span class="n">best_model_ch</span><span class="p">,</span><span class="n">params_best_model_ch</span><span class="p">,</span><span class="n">residuals_bestmodel_ch</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 842us/step
156/156 [==============================] - 0s 869us/step
156/156 [==============================] - 0s 886us/step
MSE: 0.01683149507465705
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 941us/step
156/156 [==============================] - 0s 653us/step
156/156 [==============================] - 0s 679us/step
MSE: 0.6391337927696552
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 985us/step
156/156 [==============================] - 0s 852us/step
156/156 [==============================] - 0s 814us/step
MSE: 0.7886544853598566
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 718us/step
156/156 [==============================] - 0s 761us/step
156/156 [==============================] - 0s 892us/step
MSE: 1.2466106830260384
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 895us/step
156/156 [==============================] - 0s 804us/step
156/156 [==============================] - 0s 922us/step
MSE: 0.09406439268562121
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 965us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 916us/step
MSE: 0.8034522606969933
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 966us/step
156/156 [==============================] - 0s 959us/step
156/156 [==============================] - 0s 954us/step
MSE: 0.23450304812371797
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 960us/step
156/156 [==============================] - 0s 934us/step
156/156 [==============================] - 0s 901us/step
MSE: 1.2391975220619318
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 734us/step
156/156 [==============================] - 0s 861us/step
156/156 [==============================] - 0s 816us/step
MSE: 0.41163656331159687
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 916us/step
156/156 [==============================] - 0s 862us/step
156/156 [==============================] - 0s 893us/step
MSE: 0.378310774336521
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 885us/step
156/156 [==============================] - 0s 897us/step
156/156 [==============================] - 0s 806us/step
MSE: 1.1631172505534795
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 795us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 972us/step
MSE: 0.8504459007987352
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 930us/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 735us/step
MSE: 0.5361116838272796
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 885us/step
156/156 [==============================] - 0s 975us/step
MSE: 0.7392851311787568
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 890us/step
156/156 [==============================] - 0s 785us/step
156/156 [==============================] - 0s 874us/step
MSE: 0.8682840874744338
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 896us/step
156/156 [==============================] - 0s 935us/step
156/156 [==============================] - 0s 919us/step
MSE: 0.6731365958702716
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 2ms/step
155/155 [==============================] - 0s 920us/step
155/155 [==============================] - 0s 856us/step
MSE: 0.057458220978932585
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 905us/step
155/155 [==============================] - 0s 882us/step
155/155 [==============================] - 0s 909us/step
MSE: 0.28384743178550675
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 861us/step
155/155 [==============================] - 0s 855us/step
155/155 [==============================] - 0s 790us/step
MSE: 0.4282568257450171
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 794us/step
155/155 [==============================] - 0s 714us/step
155/155 [==============================] - 0s 891us/step
MSE: 1.5647554459130906
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 827us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 869us/step
MSE: 0.18206447559351066
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 934us/step
155/155 [==============================] - 0s 800us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.22185670263169707
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 978us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.4685144513847944
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 835us/step
155/155 [==============================] - 0s 789us/step
155/155 [==============================] - 0s 788us/step
MSE: 0.9562479796854475
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 786us/step
155/155 [==============================] - 0s 926us/step
155/155 [==============================] - 0s 933us/step
MSE: 0.32036845081560117
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 815us/step
155/155 [==============================] - 0s 869us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.524196485223671
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 883us/step
155/155 [==============================] - 0s 913us/step
155/155 [==============================] - 0s 884us/step
MSE: 0.866232849538785
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 775us/step
155/155 [==============================] - 0s 906us/step
155/155 [==============================] - 0s 839us/step
MSE: 1.199768865532546
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 763us/step
155/155 [==============================] - 0s 856us/step
MSE: 0.39830408595952976
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 746us/step
155/155 [==============================] - 0s 878us/step
155/155 [==============================] - 0s 763us/step
MSE: 0.752090005423221
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 895us/step
155/155 [==============================] - 0s 939us/step
155/155 [==============================] - 0s 901us/step
MSE: 0.8101950942615413
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 910us/step
155/155 [==============================] - 0s 932us/step
MSE: 0.9296989407474119
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 801us/step
154/154 [==============================] - 0s 720us/step
154/154 [==============================] - 0s 971us/step
MSE: 0.02014190114998524
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 922us/step
154/154 [==============================] - 0s 902us/step
154/154 [==============================] - 0s 794us/step
MSE: 0.20454023692044734
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 798us/step
154/154 [==============================] - 0s 881us/step
154/154 [==============================] - 0s 821us/step
MSE: 0.9667698098432512
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 728us/step
154/154 [==============================] - 0s 915us/step
154/154 [==============================] - 0s 907us/step
MSE: 1.1264895187384252
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 728us/step
154/154 [==============================] - 0s 911us/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0780690754396709
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 800us/step
154/154 [==============================] - 0s 727us/step
154/154 [==============================] - 0s 902us/step
MSE: 0.4014927608457682
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 822us/step
154/154 [==============================] - 0s 909us/step
154/154 [==============================] - 0s 909us/step
MSE: 0.5954323583294487
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 923us/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 985us/step
MSE: 0.6515266592337726
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 907us/step
154/154 [==============================] - 0s 913us/step
154/154 [==============================] - 0s 828us/step
MSE: 0.11414079061193369
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 900us/step
154/154 [==============================] - 0s 898us/step
154/154 [==============================] - 0s 726us/step
MSE: 0.40431906716912475
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 754us/step
154/154 [==============================] - 0s 882us/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.9263783759816365
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 869us/step
154/154 [==============================] - 0s 852us/step
154/154 [==============================] - 0s 830us/step
MSE: 1.6758811068812174
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 912us/step
154/154 [==============================] - 0s 725us/step
154/154 [==============================] - 0s 794us/step
MSE: 0.6108311767144755
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 791us/step
154/154 [==============================] - 0s 823us/step
MSE: 0.8219798070338383
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 825us/step
154/154 [==============================] - 0s 840us/step
154/154 [==============================] - 0s 872us/step
MSE: 0.9535567878817444
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 911us/step
154/154 [==============================] - 0s 798us/step
154/154 [==============================] - 0s 890us/step
MSE: 1.3142323396332045
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 924us/step
153/153 [==============================] - 0s 872us/step
153/153 [==============================] - 0s 803us/step
MSE: 0.024500898245892386
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 733us/step
153/153 [==============================] - 0s 881us/step
153/153 [==============================] - 0s 917us/step
MSE: 0.20349056971457966
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 801us/step
153/153 [==============================] - 0s 793us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.7323437508666383
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 826us/step
153/153 [==============================] - 0s 849us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.8256702602291617
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 896us/step
153/153 [==============================] - 0s 883us/step
153/153 [==============================] - 0s 943us/step
MSE: 0.06308798557931906
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 860us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 817us/step
MSE: 0.3184795038130968
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 808us/step
153/153 [==============================] - 0s 900us/step
153/153 [==============================] - 0s 795us/step
MSE: 0.7433128294079493
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 820us/step
153/153 [==============================] - 0s 933us/step
MSE: 0.9921607378276152
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 786us/step
153/153 [==============================] - 0s 906us/step
MSE: 0.20996453025537232
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 920us/step
153/153 [==============================] - 0s 774us/step
153/153 [==============================] - 0s 770us/step
MSE: 0.4072978029814922
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 893us/step
153/153 [==============================] - 0s 862us/step
153/153 [==============================] - 0s 838us/step
MSE: 0.7545225963082601
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 785us/step
153/153 [==============================] - 0s 893us/step
153/153 [==============================] - 0s 901us/step
MSE: 1.0156228472149904
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 880us/step
153/153 [==============================] - 0s 984us/step
153/153 [==============================] - 0s 994us/step
MSE: 0.41634676733220616
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 739us/step
153/153 [==============================] - 0s 905us/step
153/153 [==============================] - 0s 822us/step
MSE: 0.7365840109808998
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 801us/step
153/153 [==============================] - 0s 795us/step
153/153 [==============================] - 0s 848us/step
MSE: 1.0687496983043143
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 839us/step
153/153 [==============================] - 0s 875us/step
153/153 [==============================] - 0s 849us/step
MSE: 0.9427305730702804
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 841us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 907us/step
MSE: 0.001173156163996963
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 857us/step
156/156 [==============================] - 0s 909us/step
156/156 [==============================] - 0s 961us/step
MSE: 0.0005648609622783676
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 857us/step
156/156 [==============================] - 0s 870us/step
156/156 [==============================] - 0s 982us/step
MSE: 0.0014791228177468245
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 793us/step
156/156 [==============================] - 0s 928us/step
156/156 [==============================] - 0s 951us/step
MSE: 0.08159624888700064
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 715us/step
MSE: 0.0022105504644593862
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 932us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 755us/step
MSE: 0.004213743133397566
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 816us/step
156/156 [==============================] - 0s 835us/step
156/156 [==============================] - 0s 787us/step
MSE: 0.004432067773778793
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 831us/step
156/156 [==============================] - 0s 853us/step
156/156 [==============================] - 0s 932us/step
MSE: 0.0054944265284313995
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 895us/step
156/156 [==============================] - 0s 784us/step
156/156 [==============================] - 0s 858us/step
MSE: 0.004871164730142851
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 951us/step
156/156 [==============================] - 0s 897us/step
156/156 [==============================] - 0s 780us/step
MSE: 0.011899784518393148
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 824us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 814us/step
MSE: 0.02199927220626074
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 863us/step
156/156 [==============================] - 0s 872us/step
156/156 [==============================] - 0s 834us/step
MSE: 0.16563841669815166
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 705us/step
156/156 [==============================] - 0s 885us/step
156/156 [==============================] - 0s 984us/step
MSE: 0.02267162219148764
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 885us/step
156/156 [==============================] - 0s 850us/step
156/156 [==============================] - 0s 848us/step
MSE: 0.038807798529310246
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 875us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 906us/step
MSE: 0.11404324412888789
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 786us/step
156/156 [==============================] - 0s 703us/step
156/156 [==============================] - 0s 816us/step
MSE: 0.17671134388771917
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 791us/step
155/155 [==============================] - 0s 926us/step
155/155 [==============================] - 0s 888us/step
MSE: 0.0008658402924780689
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 936us/step
155/155 [==============================] - 0s 910us/step
155/155 [==============================] - 0s 826us/step
MSE: 0.002774204734249519
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 877us/step
155/155 [==============================] - 0s 922us/step
155/155 [==============================] - 0s 887us/step
MSE: 0.004339360434906154
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 905us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 876us/step
MSE: 0.01550292070454548
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 876us/step
155/155 [==============================] - 0s 854us/step
155/155 [==============================] - 0s 859us/step
MSE: 0.007659425149733129
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 852us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 785us/step
MSE: 0.004552681660173997
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 799us/step
155/155 [==============================] - 0s 916us/step
155/155 [==============================] - 0s 872us/step
MSE: 0.009828729185161781
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 829us/step
155/155 [==============================] - 0s 763us/step
155/155 [==============================] - 0s 791us/step
MSE: 0.016497752658479116
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 867us/step
155/155 [==============================] - 0s 937us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.006301469486052753
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 809us/step
155/155 [==============================] - 0s 969us/step
155/155 [==============================] - 0s 786us/step
MSE: 0.019893917421782977
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 909us/step
155/155 [==============================] - 0s 957us/step
155/155 [==============================] - 0s 993us/step
MSE: 0.03375769109835765
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 921us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 979us/step
MSE: 0.03757489809703908
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 861us/step
155/155 [==============================] - 0s 984us/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.026641780912668427
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 953us/step
155/155 [==============================] - 0s 920us/step
155/155 [==============================] - 0s 792us/step
MSE: 0.05436272056297407
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 765us/step
155/155 [==============================] - 0s 933us/step
155/155 [==============================] - 0s 914us/step
MSE: 0.12207825124249634
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 795us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 905us/step
MSE: 0.31369186043523334
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 796us/step
154/154 [==============================] - 0s 875us/step
MSE: 0.0006151015959822233
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 928us/step
154/154 [==============================] - 0s 811us/step
154/154 [==============================] - 0s 899us/step
MSE: 0.0012953933278160464
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 961us/step
154/154 [==============================] - 0s 914us/step
MSE: 0.0023759059497142562
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 825us/step
154/154 [==============================] - 0s 892us/step
154/154 [==============================] - 0s 989us/step
MSE: 0.005311361719775263
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 935us/step
154/154 [==============================] - 0s 975us/step
MSE: 0.002368638907964698
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 962us/step
154/154 [==============================] - 0s 860us/step
MSE: 0.006403004019971986
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 841us/step
154/154 [==============================] - 0s 799us/step
154/154 [==============================] - 0s 896us/step
MSE: 0.0110438665222441
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 837us/step
154/154 [==============================] - 0s 922us/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.01857373711953116
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 800us/step
154/154 [==============================] - 0s 893us/step
154/154 [==============================] - 0s 764us/step
MSE: 0.017450724811685362
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 940us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 829us/step
MSE: 0.021747271156604128
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 797us/step
154/154 [==============================] - 0s 971us/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.05932549421050613
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 849us/step
154/154 [==============================] - 0s 795us/step
MSE: 0.06520114964707573
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 868us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 924us/step
MSE: 0.07854688684855622
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 945us/step
154/154 [==============================] - 0s 880us/step
154/154 [==============================] - 0s 887us/step
MSE: 0.04388342301620961
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 979us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 969us/step
MSE: 0.17434084961523338
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 943us/step
154/154 [==============================] - 0s 971us/step
154/154 [==============================] - 0s 899us/step
MSE: 0.34282045717350756
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.003036834453352501
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 843us/step
153/153 [==============================] - 0s 860us/step
MSE: 0.0025200569355514403
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 832us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 898us/step
MSE: 0.00313228914286278
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 803us/step
153/153 [==============================] - 0s 953us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0072707015999513925
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 726us/step
153/153 [==============================] - 0s 900us/step
153/153 [==============================] - 0s 998us/step
MSE: 0.004773187222738506
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 728us/step
153/153 [==============================] - 0s 922us/step
153/153 [==============================] - 0s 923us/step
MSE: 0.005326383363244527
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 890us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 923us/step
MSE: 0.019055191993604923
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 952us/step
153/153 [==============================] - 0s 794us/step
153/153 [==============================] - 0s 920us/step
MSE: 0.07797886063102266
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 851us/step
153/153 [==============================] - 0s 945us/step
153/153 [==============================] - 0s 921us/step
MSE: 0.0032022344682846315
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 977us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.026131515136854317
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 938us/step
153/153 [==============================] - 0s 857us/step
153/153 [==============================] - 0s 892us/step
MSE: 0.04166461420289225
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 856us/step
153/153 [==============================] - 0s 877us/step
153/153 [==============================] - 0s 948us/step
MSE: 0.13008989616298458
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 772us/step
153/153 [==============================] - 0s 840us/step
153/153 [==============================] - 0s 816us/step
MSE: 0.045037651624191107
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 929us/step
153/153 [==============================] - 0s 795us/step
153/153 [==============================] - 0s 939us/step
MSE: 0.08042796916380322
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 865us/step
153/153 [==============================] - 0s 878us/step
153/153 [==============================] - 0s 881us/step
MSE: 0.1659465616577429
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 926us/step
153/153 [==============================] - 0s 778us/step
MSE: 0.45804703269273694
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 764us/step
156/156 [==============================] - 0s 779us/step
156/156 [==============================] - 0s 976us/step
MSE: 0.0005389483650959115
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 983us/step
156/156 [==============================] - 0s 993us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.00042527158904425214
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 885us/step
156/156 [==============================] - 0s 974us/step
MSE: 0.00043593062101516617
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 869us/step
156/156 [==============================] - 0s 912us/step
156/156 [==============================] - 0s 999us/step
MSE: 0.006508660552860697
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 786us/step
156/156 [==============================] - 0s 886us/step
156/156 [==============================] - 0s 967us/step
MSE: 0.0006876763041450859
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 905us/step
156/156 [==============================] - 0s 806us/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.000563389490493892
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 889us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 905us/step
MSE: 0.0005837296905748286
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 812us/step
156/156 [==============================] - 0s 903us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0025980437575646724
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 990us/step
156/156 [==============================] - 0s 905us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0004185888775102503
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 930us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0007570463140527428
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 791us/step
MSE: 0.0006041844257769671
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 926us/step
156/156 [==============================] - 0s 927us/step
156/156 [==============================] - 0s 998us/step
MSE: 0.0094085798790761
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 990us/step
156/156 [==============================] - 0s 900us/step
MSE: 0.0005730192382147605
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.00047943113460890323
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 930us/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 980us/step
MSE: 0.0005188574823571582
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 953us/step
156/156 [==============================] - 0s 826us/step
156/156 [==============================] - 0s 898us/step
MSE: 0.006190030057605034
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 790us/step
155/155 [==============================] - 0s 787us/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0006301050556514539
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 973us/step
155/155 [==============================] - 0s 902us/step
MSE: 0.0005118545274428226
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 893us/step
155/155 [==============================] - 0s 934us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0005150457515843768
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 888us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 977us/step
MSE: 0.0028948959830349293
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 902us/step
155/155 [==============================] - 0s 854us/step
155/155 [==============================] - 0s 922us/step
MSE: 0.0004442981494359388
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 932us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0012193355236853275
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 940us/step
155/155 [==============================] - 0s 979us/step
MSE: 0.0007698895099993632
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 990us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0025521360300340044
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 918us/step
155/155 [==============================] - 0s 908us/step
155/155 [==============================] - 0s 986us/step
MSE: 0.001441136809880074
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0004508532276332619
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 996us/step
155/155 [==============================] - 0s 961us/step
MSE: 0.0008431556872490517
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 796us/step
155/155 [==============================] - 0s 793us/step
155/155 [==============================] - 0s 931us/step
MSE: 0.0026158454303006084
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 938us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0016391968118124722
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0027700710006940315
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 945us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 986us/step
MSE: 0.0018757824561618757
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0024179492982975086
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0010586473919746685
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0005514243773171743
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0004275305365060824
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.002222531922140761
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0009667074240514379
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.00047595834596683
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0007848261223309062
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0017957218232340405
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0005949842455558933
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.001324557261064652
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.00048078027926260766
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0023719264410389136
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.004938503015459793
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0007845552799128188
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0023069492119388003
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0023725466748490466
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0007163477526167737
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0005212026222496771
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 0.0004871188052364789
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.005197932377630456
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0023114228710897455
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.000736392155232242
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0012989560981577324
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0038894140144053913
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0005245520182372409
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0005157483435292632
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0023635600951865225
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0069555726888781136
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0017334778515578706
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0048461806285342805
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.000598893113870904
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.012490427846924987
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00040383683593035925
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00041315317530571
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 0.00040792349810386076
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.001412951605913933
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0004469940377210814
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 0.00042840009816048344
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00040654646930110176
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0006251272473099514
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 0.000982105027797173
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 0.0005340443161396951
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 0.00042359055830046364
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0009232394224332622
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0005644831391976482
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 0.00044366023946346183
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00044442682315679803
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0008116674321688073
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003802384233425796
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.000403618884394318
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003979274555209202
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.000814729735046737
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 0.0005303277215102706
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00041027968775507207
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0004040099015201611
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.001599221169323627
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0007356163515210524
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0006633212554093863
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0005045127078013301
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0012997589907224373
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0017042359794033673
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.00045064757142274987
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00045821580991697066
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0005299987339915412
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0012504517196594146
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00041099126997126814
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00036337246334405777
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.003992353632327201
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00053473905404928
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.000590514693268
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0003938825629198303
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0033951913736129315
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0005767581769663473
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0010434526142552006
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00040595544470383083
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 3ms/step
MSE: 0.002939971236189088
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0026136271201299237
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0009209309919969007
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0004170241213882416
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.004487695134665915
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0005220202292533083
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0004917608447617677
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0003916042082784101
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0005670138390003193
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0006005199770653233
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0005366303925481423
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0003991575897478845
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0009301098759370229
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0005825865680343567
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0006385716642133684
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0005898050508498556
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0006728420123341875
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.010231876411277091
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0013765634670244724
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0010582038225519354
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0016833676529419298
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_ch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 10000, &#39;batchsize&#39;: 64, &#39;dropout_rate&#39;: 0.2, &#39;horizon&#39;: 21, &#39;window&#39;: 21, &#39;MSE&#39;: 0.00036337246334405777}
</pre></div>
</div>
</div>
</div>
<p>Los mejores parametros para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> fueron:
{‘neurons’: 10000, ‘batchsize’: 64, ‘dropout_rate’: 0.2, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 0.00036826683431922077}. De las series analizadas podemos decir que 10000 neuronas y ventanas de 7 valores entregan mejores resultados</p>
<section id="id1">
<h3>Residuales<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo  para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_ch</span>


<span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.004938
1        2             0.004938
2        3             0.004938
3        4             0.004938
4        5             0.004938
5        6             0.004938
6        7             0.004938
7        8             0.004938
8        9             0.004938
9       10             0.004938
</pre></div>
</div>
<img alt="_images/0f3ea60eeb2259d23f8a727bfac7c56c342010372ef300db7d7816eb1396f698.png" src="_images/0f3ea60eeb2259d23f8a727bfac7c56c342010372ef300db7d7816eb1396f698.png" />
<img alt="_images/4fc0982766d8aa04d0d988bfcda368f2f2f8d6b052b467ac1c8bd969d3054a77.png" src="_images/4fc0982766d8aa04d0d988bfcda368f2f2f8d6b052b467ac1c8bd969d3054a77.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_24512\3775612513.py:37: MatplotlibDeprecationWarning:

The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
</pre></div>
</div>
<img alt="_images/5a9fdc0fb822dd1a57734af2d5f4570fb6661ab71317c72041659f03cf870f9f.png" src="_images/5a9fdc0fb822dd1a57734af2d5f4570fb6661ab71317c72041659f03cf870f9f.png" />
<img alt="_images/20cf0648239b5aed3fea74d7cc32530f21240133afd831a4490a9419a7b4d0a5.png" src="_images/20cf0648239b5aed3fea74d7cc32530f21240133afd831a4490a9419a7b4d0a5.png" />
<img alt="_images/b35e94b9c874f6073f051887fd3689454925d2ceb91ee94b0bc283910dc46860.png" src="_images/b35e94b9c874f6073f051887fd3689454925d2ceb91ee94b0bc283910dc46860.png" />
<img alt="_images/80b22ae911f851f55841ecb4e01a23b98a725439e25ba330742cd0f02c0e7809.png" src="_images/80b22ae911f851f55841ecb4e01a23b98a725439e25ba330742cd0f02c0e7809.png" />
<img alt="_images/d018a05dce316e4ec5e87e52b07b032274d13993ea55bbe3b360aabc9b1e3314.png" src="_images/d018a05dce316e4ec5e87e52b07b032274d13993ea55bbe3b360aabc9b1e3314.png" />
<img alt="_images/8d617c1eb86a2711d5bc6cee38ead224213ca8938cdf137e63683f51c69544dd.png" src="_images/8d617c1eb86a2711d5bc6cee38ead224213ca8938cdf137e63683f51c69544dd.png" />
<img alt="_images/ab296324770647689311ca27cd1eb493c5c83cb8b91ca171e86251097f004411.png" src="_images/ab296324770647689311ca27cd1eb493c5c83cb8b91ca171e86251097f004411.png" />
<img alt="_images/f65aaa7bb575a71a4da7d4b1376e78b88d9e15205e0061f7b7656c3437d7205a.png" src="_images/f65aaa7bb575a71a4da7d4b1376e78b88d9e15205e0061f7b7656c3437d7205a.png" />
<img alt="_images/6d659c8021f3210250c2424b2681af3ae0bc7629e78d8a068a2c7b43ad9a7b43.png" src="_images/6d659c8021f3210250c2424b2681af3ae0bc7629e78d8a068a2c7b43ad9a7b43.png" />
<img alt="_images/5dceed473e35ecc52c17350575d48d506d4b8b7b9c8140fff610096732f5c06c.png" src="_images/5dceed473e35ecc52c17350575d48d506d4b8b7b9c8140fff610096732f5c06c.png" />
<img alt="_images/868dea7473c8d065677a6f950c46c1009a4e77acdb6fc8826069bcd2f318e636.png" src="_images/868dea7473c8d065677a6f950c46c1009a4e77acdb6fc8826069bcd2f318e636.png" />
<img alt="_images/876dca15df2713cd8fddbf555105a93476ed89ef4383df87f7002271be8fdf1c.png" src="_images/876dca15df2713cd8fddbf555105a93476ed89ef4383df87f7002271be8fdf1c.png" />
<img alt="_images/c153eceeab47242ebdb584bb87518c3a0c8bce575c896b3f687be886251af6c8.png" src="_images/c153eceeab47242ebdb584bb87518c3a0c8bce575c896b3f687be886251af6c8.png" />
</div>
</div>
<p>Los residuales no cumplen con los supuestos al igual que en la serie price eso puede deberse al sobre ajuste del modelo</p>
<section id="id2">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_ch</span>  
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">51</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">6</span>         <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="ne">AttributeError</span>: &#39;function&#39; object has no attribute &#39;append&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>De la grafica de MSE vs la iteración del modelo podemos ver que a medida que se aumentan las neuronas ( que fueron el búcle más grande) el modelo tiene mejores metricas pero esto también puede implicar sobre ajuste del modelo</p>
</section>
<section id="id3">
<h4>Boxplot<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_ch</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_ch</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre train, test, validation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" src="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" />
</div>
</div>
<p>La medianas se ven similares, incluso se logra ver que las casjas son iguales. Por lo que se puede afirmar que el modelo tuvo un comportamiento constante. como los puntos por fuera de las cajas son similares señala que los datos eran atípicos y no son un error del modelo.</p>
</section>
</section>
<section id="id4">
<h3>Prediciones<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_ch</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datos</span><span class="p">):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Como se ve en la gráfica el modelo es capaz de identificar las tendencias y la serie en general a excepción de los picos abrutos.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ejercicio2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Modelos estadísticos</p>
      </div>
    </a>
    <a class="right-next"
       href="RNN.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MODELO RNN</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johana y Claudia
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>