
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MODELO MLP &#8212; Parcial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MLP';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MODELO RNN" href="RNN.html" />
    <link rel="prev" title="Modelos estadísticos" href="Ejercicio2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Parcial</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial Series de tiempo
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio1.html">Parcial 1 de Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ejercicio2.html">Modelos estadísticos</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">MODELO MLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="RNN.html">MODELO RNN</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MLP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MODELO MLP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelo-mlp">
<h1>MODELO MLP<a class="headerlink" href="#modelo-mlp" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
<section id="datos">
<h2>Datos<a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\claud\Downloads\Bitcoin Historical Data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Vol.</th>
      <th>Change %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03/24/2024</td>
      <td>67,211.9</td>
      <td>64,036.5</td>
      <td>67,587.8</td>
      <td>63,812.9</td>
      <td>65.59K</td>
      <td>4.96%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03/23/2024</td>
      <td>64,037.8</td>
      <td>63,785.6</td>
      <td>65,972.4</td>
      <td>63,074.9</td>
      <td>35.11K</td>
      <td>0.40%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03/22/2024</td>
      <td>63,785.5</td>
      <td>65,501.5</td>
      <td>66,633.3</td>
      <td>62,328.3</td>
      <td>72.43K</td>
      <td>-2.62%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03/21/2024</td>
      <td>65,503.8</td>
      <td>67,860.0</td>
      <td>68,161.7</td>
      <td>64,616.1</td>
      <td>75.26K</td>
      <td>-3.46%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03/20/2024</td>
      <td>67,854.0</td>
      <td>62,046.8</td>
      <td>68,029.5</td>
      <td>60,850.9</td>
      <td>133.53K</td>
      <td>9.35%</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4994</th>
      <td>07/22/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>2.16K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4995</th>
      <td>07/21/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.58K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>07/20/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.26K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>07/19/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.57K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>07/18/2010</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.08K</td>
      <td>0.00%</td>
    </tr>
  </tbody>
</table>
<p>4999 rows × 7 columns</p>
</div></div></div>
</div>
<p>Para que los datos estén en el formato correcto se les aplicará el siguiente proceso de eliminación de formatos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar comas y convertir las columnas relevantes a float</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="c1"># Función para convertir valores con &#39;K&#39;, &#39;M&#39;, &#39;B&#39; o números directos</span>
<span class="k">def</span> <span class="nf">convert_volume</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="c1"># Verificar si el valor ya es numérico</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>  <span class="c1"># Devolver el valor si ya es numérico</span>
    <span class="k">elif</span> <span class="s1">&#39;K&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000</span>
    <span class="k">elif</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000</span>
    <span class="k">elif</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000_000</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="c1"># Aplicar la función a la columna &#39;Vol.&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_volume</span><span class="p">)</span>

<span class="c1"># Verificar que la conversión haya sido exitosa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Vol.
0   65590.0
1   35110.0
2   72430.0
3   75260.0
4  133530.0
</pre></div>
</div>
</div>
</div>
<p>Se verifica el formato de la fecha y se agrega la columnna indice</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegurarse de que la columna &quot;Date&quot; sea de tipo datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span>
<span class="c1"># Ordenar los datos por fecha de forma ascendente</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Verificar si hay valores nulos en cada columna</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="c1"># Alternativa: Mostrar las filas que contengan valores faltantes</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filas con datos faltantes:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Asegúrate de que la columna &#39;Date&#39; esté en formato datetime</span>

<span class="c1"># Convertir la fecha a un timestamp (número de días desde Epoch)</span>

<span class="c1"># Ver las primeras filas con la nueva columna numérica</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;indice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date        0
Price       0
Open        0
High        0
Low         0
Vol.        6
Change %    0
dtype: int64
Filas con datos faltantes:
          Date  Price  Open  High   Low  Vol. Change %
337 2011-06-20   17.5  17.5  17.5  17.5   NaN    0.00%
338 2011-06-21   17.5  17.5  17.5  17.5   NaN    0.00%
339 2011-06-22   17.5  17.5  17.5  17.5   NaN    0.00%
340 2011-06-23   17.5  17.5  17.5  17.5   NaN    0.00%
341 2011-06-24   17.5  17.5  17.5  17.5   NaN    0.00%
342 2011-06-25   17.5  17.5  17.5  17.5   NaN    0.00%
</pre></div>
</div>
</div>
</div>
</section>
<section id="funciones">
<h2>Funciones<a class="headerlink" href="#funciones" title="Link to this heading">#</a></h2>
<section id="ventanas-deslizantes">
<h3>Ventanas deslizantes<a class="headerlink" href="#ventanas-deslizantes" title="Link to this heading">#</a></h3>
<p>Para esto creamos una función que divide los datos en entrenamiento, validación y prueba. Esta función avanca con un paso de 1. las ventanas y el horizonte de predicción son variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">create_sliding_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1"># Generar ventanas deslizantes con sus índices correspondientes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Entrenamiento</span>
        <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
        <span class="n">Y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Validación</span>
        <span class="n">X_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Prueba</span>
        <span class="n">X_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

    <span class="c1"># Convertir a arrays de NumPy</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># (n_samples, window_size)</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">Y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>  <span class="c1"># (n_samples, horizon)</span>
    <span class="n">Y_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_val</span><span class="p">)</span>
    <span class="n">Y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>

    <span class="c1"># Asegurarse de que los datos están en la forma adecuada para MLP (n_samples, n_features)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>  <span class="c1"># Eliminar dimensión extra</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo">
<h3>Construcción del Modelo<a class="headerlink" href="#construccion-del-modelo" title="Link to this heading">#</a></h3>
<p>Creamos una función para crear el modelo teniendo en cuenta los parametros de las iteraciones neurons, window, dropout_rate, horizon. Batch size se aplicará más adelante</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Input</span>

<span class="k">def</span> <span class="nf">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">window</span><span class="p">,)))</span> 
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">horizon</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">q_stat</span><span class="p">,</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metricas">
<h3>Métricas<a class="headerlink" href="#metricas" title="Link to this heading">#</a></h3>
<p>Creamos una función que calcule las metricas importantes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">metricas</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    
    <span class="c1"># Calcular métricas en Validación</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Advertencia: Las predicciones contienen NaN.&quot;</span><span class="p">)</span>
        <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">windows</span> <span class="o">-</span> <span class="n">pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">windows</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>

        
        <span class="c1"># Guardar métricas del conjunto de validación junto con pruebas de hipótesis</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
            <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
            <span class="s1">&#39;Dropout&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
            <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
            <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span><span class="p">,</span> <span class="n">q_stat</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="funcion-de-optimizacion">
<h3>Función de optimización<a class="headerlink" href="#funcion-de-optimizacion" title="Link to this heading">#</a></h3>
<p>se creo una función con la cual se itera entre todas las posibles combinaciones de paramtros. Se tiene en cuenta el early stoping y la estabilización de la metrica mse para encontar el mejor modelo. luego de que el mse no varie más del 5% 5 iteraciones seguidas se detiene. Además se guardan los residuos y metricas de cada modelo para su posterior uso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">busqueda</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">windows</span><span class="p">,</span> <span class="n">horizons</span><span class="p">,</span> <span class="n">dropout_rates</span><span class="p">,</span> <span class="n">batchsizes</span><span class="p">,</span> <span class="n">neurons_list</span><span class="p">):</span>
    <span class="n">validation_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">train_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">residual_hist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">best_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> 
    <span class="n">previous_mse</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Para rastrear el MSE de la iteración anterior</span>
    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Contador para rastrear iteraciones estables</span>

    <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">neurons</span> <span class="ow">in</span> <span class="n">neurons_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">horizon</span> <span class="ow">in</span> <span class="n">horizons</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="n">horizon</span><span class="p">:</span>
                    <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_sliding_windows</span><span class="p">(</span>
                        <span class="n">datos</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">dropout_rate</span> <span class="ow">in</span> <span class="n">dropout_rates</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">batchsize</span> <span class="ow">in</span> <span class="n">batchsizes</span><span class="p">:</span>

                            <span class="c1"># Crear y entrenar el modelo</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entrenando modelo con </span><span class="si">{</span><span class="n">neurons</span><span class="si">}</span><span class="s2"> neuronas, dropout </span><span class="si">{</span><span class="n">dropout_rate</span><span class="si">}</span><span class="s2">, &quot;</span>
                                  <span class="sa">f</span><span class="s2">&quot;batch size </span><span class="si">{</span><span class="n">batchsize</span><span class="si">}</span><span class="s2">, horizon </span><span class="si">{</span><span class="n">horizon</span><span class="si">}</span><span class="s2">, window </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">model</span> <span class="o">=</span> <span class="n">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>

                            <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
                                <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                            <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                                <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
                                <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">],</span>
                                <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span>
                            <span class="p">)</span>

                            <span class="c1"># Predicciones y cálculo de residuos</span>
                            <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
                            <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
                            <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>

                            <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_val</span> <span class="o">-</span> <span class="n">val_pred</span>  <span class="c1"># Residuos de validación</span>
                            <span class="n">residual_hist</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                                <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                <span class="s1">&#39;residuals&#39;</span><span class="p">:</span> <span class="n">residuals</span>
                            <span class="p">})</span>

                            <span class="c1"># Calcular métricas en validación</span>
                            
                            <span class="n">metricas_val</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">val_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">validation_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_val</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en prueba</span>
                            <span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">test_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en entrenamiento</span>
                            <span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">train_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">metricas_val</span><span class="p">:</span>
                                <span class="n">mse</span> <span class="o">=</span> <span class="n">metricas_val</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="c1"># Verificar la fluctuación del MSE</span>
                                <span class="k">if</span> <span class="n">previous_mse</span><span class="p">:</span>
                                    <span class="n">variation</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mse</span> <span class="o">-</span> <span class="n">previous_mse</span><span class="p">)</span> <span class="o">/</span> <span class="n">previous_mse</span>
                                    <span class="k">if</span> <span class="n">variation</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">+=</span> <span class="mi">1</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fluctuación menor al 5% en el MSE por </span><span class="si">{</span><span class="n">stable_iterations</span><span class="si">}</span><span class="s2"> iteración(es).&quot;</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Reiniciar contador si hay variación mayor al 5%</span>

                                    <span class="k">if</span> <span class="n">stable_iterations</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fluctuación menor al 5</span><span class="si">% d</span><span class="s2">urante 5 iteraciones consecutivas. Deteniendo la búsqueda.&quot;</span><span class="p">)</span>
                                        <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> 
                                                <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>

                                <span class="n">previous_mse</span> <span class="o">=</span> <span class="n">mse</span>

                                <span class="c1"># Guardar el mejor modelo si es necesario</span>
                                <span class="k">if</span> <span class="n">mse</span> <span class="o">&lt;</span> <span class="n">best_score</span><span class="p">:</span>
                                    <span class="n">best_score</span> <span class="o">=</span> <span class="n">mse</span>
                                    <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
                                    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                        <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                        <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                        <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                        <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span>
                                    <span class="p">}</span>
                                    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="n">residuals</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="serie-price">
<h2>Serie Price<a class="headerlink" href="#serie-price" title="Link to this heading">#</a></h2>
<p>Utilización de las funciones para encontrar los mejores parametros para la serie de tiempo <code class="docutils literal notranslate"><span class="pre">Price</span></code></p>
<section id="modelo">
<h3>Modelo<a class="headerlink" href="#modelo" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>


<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="n">validation_metrics_price</span><span class="p">,</span><span class="n">test_metrics_price</span><span class="p">,</span><span class="n">train_metrics_price</span><span class="p">,</span><span class="n">residual_hist_price</span><span class="p">,</span><span class="n">best_model_price</span><span class="p">,</span><span class="n">params_best_model_price</span><span class="p">,</span><span class="n">residuals_bestmodel_price</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 709us/step
156/156 [==============================] - 0s 711us/step
156/156 [==============================] - 0s 711us/step
MSE: 29769596.09965461
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 716us/step
156/156 [==============================] - 0s 607us/step
156/156 [==============================] - 0s 708us/step
MSE: 237090755.9195588
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 696us/step
156/156 [==============================] - 0s 729us/step
156/156 [==============================] - 0s 631us/step
MSE: 437918731.98866457
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 716us/step
156/156 [==============================] - 0s 708us/step
156/156 [==============================] - 0s 612us/step
MSE: 211145347.08928603
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 607us/step
156/156 [==============================] - 0s 617us/step
156/156 [==============================] - 0s 605us/step
MSE: 32448104.528002378
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 725us/step
156/156 [==============================] - 0s 676us/step
156/156 [==============================] - 0s 824us/step
MSE: 242957962.24745846
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 625us/step
156/156 [==============================] - 0s 768us/step
156/156 [==============================] - 0s 558us/step
MSE: 147874721.31136388
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 575us/step
156/156 [==============================] - 0s 615us/step
156/156 [==============================] - 0s 573us/step
MSE: 208971677.48712477
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 569us/step
156/156 [==============================] - 0s 577us/step
156/156 [==============================] - 0s 614us/step
MSE: 91081969.10036126
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 560us/step
156/156 [==============================] - 0s 612us/step
156/156 [==============================] - 0s 900us/step
MSE: 155734438.56294647
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 602us/step
156/156 [==============================] - 0s 495us/step
156/156 [==============================] - 0s 527us/step
MSE: 764329143.7946036
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 599us/step
156/156 [==============================] - 0s 557us/step
MSE: 485759362.51011235
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 643us/step
156/156 [==============================] - 0s 528us/step
156/156 [==============================] - 0s 613us/step
MSE: 353478175.964334
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 638us/step
156/156 [==============================] - 0s 597us/step
156/156 [==============================] - 0s 501us/step
MSE: 275874680.86870617
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 532us/step
156/156 [==============================] - 0s 931us/step
156/156 [==============================] - 0s 611us/step
MSE: 248656181.8059418
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 546us/step
156/156 [==============================] - 0s 601us/step
156/156 [==============================] - 0s 646us/step
MSE: 315721197.48340845
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 567us/step
155/155 [==============================] - 0s 735us/step
155/155 [==============================] - 0s 716us/step
MSE: 21311747.398839645
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 570us/step
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 625us/step
MSE: 57375058.078714706
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 631us/step
155/155 [==============================] - 0s 564us/step
155/155 [==============================] - 0s 496us/step
MSE: 158773853.10581452
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 499us/step
155/155 [==============================] - 0s 578us/step
155/155 [==============================] - 0s 618us/step
MSE: 280693305.09539294
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 525us/step
155/155 [==============================] - 0s 503us/step
155/155 [==============================] - 0s 562us/step
MSE: 78923658.78732558
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 491us/step
155/155 [==============================] - 0s 590us/step
155/155 [==============================] - 0s 586us/step
MSE: 70955266.9681799
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 553us/step
155/155 [==============================] - 0s 499us/step
155/155 [==============================] - 0s 538us/step
MSE: 304316188.3208784
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 545us/step
155/155 [==============================] - 0s 556us/step
MSE: 328553403.4859146
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 533us/step
155/155 [==============================] - 0s 548us/step
155/155 [==============================] - 0s 612us/step
MSE: 97166014.64334576
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 605us/step
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 506us/step
MSE: 133300782.99391468
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 562us/step
155/155 [==============================] - 0s 591us/step
155/155 [==============================] - 0s 590us/step
MSE: 334421427.0777112
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 588us/step
155/155 [==============================] - 0s 575us/step
155/155 [==============================] - 0s 529us/step
MSE: 299758576.05586237
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 574us/step
155/155 [==============================] - 0s 567us/step
155/155 [==============================] - 0s 592us/step
MSE: 304338008.90275866
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 573us/step
155/155 [==============================] - 0s 533us/step
155/155 [==============================] - 0s 936us/step
MSE: 270221095.07045764
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 599us/step
155/155 [==============================] - 0s 530us/step
155/155 [==============================] - 0s 591us/step
MSE: 280384018.54984057
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 548us/step
155/155 [==============================] - 0s 600us/step
155/155 [==============================] - 0s 612us/step
MSE: 227189317.28799233
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 565us/step
154/154 [==============================] - 0s 574us/step
154/154 [==============================] - 0s 643us/step
MSE: 13240246.600628546
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 567us/step
154/154 [==============================] - 0s 616us/step
154/154 [==============================] - 0s 651us/step
MSE: 87506823.4356403
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 559us/step
154/154 [==============================] - 0s 594us/step
154/154 [==============================] - 0s 636us/step
MSE: 323071132.6329074
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 603us/step
154/154 [==============================] - 0s 651us/step
154/154 [==============================] - 0s 583us/step
MSE: 569887508.5334202
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 650us/step
154/154 [==============================] - 0s 545us/step
154/154 [==============================] - 0s 615us/step
MSE: 52046759.220221795
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 561us/step
154/154 [==============================] - 0s 518us/step
154/154 [==============================] - 0s 510us/step
MSE: 66481733.084389426
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 651us/step
154/154 [==============================] - 0s 596us/step
154/154 [==============================] - 0s 629us/step
MSE: 265686775.1962452
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 629us/step
154/154 [==============================] - 0s 546us/step
154/154 [==============================] - 0s 607us/step
MSE: 313318283.98880714
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 493us/step
154/154 [==============================] - 0s 504us/step
154/154 [==============================] - 0s 604us/step
MSE: 117993012.79574668
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 595us/step
154/154 [==============================] - 0s 510us/step
154/154 [==============================] - 0s 595us/step
MSE: 150240072.8423567
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 500us/step
154/154 [==============================] - 0s 601us/step
154/154 [==============================] - 0s 553us/step
MSE: 189969458.693802
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 593us/step
154/154 [==============================] - 0s 547us/step
154/154 [==============================] - 0s 547us/step
MSE: 377767684.69666797
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 519us/step
154/154 [==============================] - 0s 559us/step
154/154 [==============================] - 0s 617us/step
MSE: 241362235.81023443
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 589us/step
154/154 [==============================] - 0s 942us/step
154/154 [==============================] - 0s 599us/step
MSE: 283132095.0790578
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 616us/step
154/154 [==============================] - 0s 550us/step
154/154 [==============================] - 0s 620us/step
MSE: 328039854.2612205
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 504us/step
154/154 [==============================] - 0s 584us/step
154/154 [==============================] - 0s 563us/step
MSE: 326003572.0060443
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 636us/step
153/153 [==============================] - 0s 663us/step
153/153 [==============================] - 0s 870us/step
MSE: 43128357.54124783
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 670us/step
153/153 [==============================] - 0s 750us/step
153/153 [==============================] - 0s 655us/step
MSE: 55131532.53168816
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 560us/step
153/153 [==============================] - 0s 581us/step
153/153 [==============================] - 0s 639us/step
MSE: 235655115.94310623
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 580us/step
153/153 [==============================] - 0s 594us/step
153/153 [==============================] - 0s 546us/step
MSE: 274071180.0382147
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 633us/step
153/153 [==============================] - 0s 570us/step
153/153 [==============================] - 0s 610us/step
MSE: 20427287.63316691
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 583us/step
153/153 [==============================] - 0s 594us/step
153/153 [==============================] - 0s 627us/step
MSE: 68159394.06874794
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 555us/step
153/153 [==============================] - 0s 605us/step
MSE: 206075513.82204723
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 532us/step
153/153 [==============================] - 0s 548us/step
153/153 [==============================] - 0s 569us/step
MSE: 197720637.17582375
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 626us/step
153/153 [==============================] - 0s 496us/step
153/153 [==============================] - 0s 596us/step
MSE: 81356136.11995532
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 582us/step
153/153 [==============================] - 0s 513us/step
153/153 [==============================] - 0s 641us/step
MSE: 137534752.5374846
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 561us/step
153/153 [==============================] - 0s 584us/step
153/153 [==============================] - 0s 608us/step
MSE: 296382041.17545164
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 656us/step
153/153 [==============================] - 0s 509us/step
153/153 [==============================] - 0s 595us/step
MSE: 261833492.40927505
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 607us/step
153/153 [==============================] - 0s 984us/step
153/153 [==============================] - 0s 582us/step
MSE: 214838511.09481403
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 605us/step
153/153 [==============================] - 0s 588us/step
153/153 [==============================] - 0s 523us/step
MSE: 292931797.402231
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 577us/step
153/153 [==============================] - 0s 622us/step
153/153 [==============================] - 0s 575us/step
MSE: 295449707.7334919
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 600us/step
153/153 [==============================] - 0s 608us/step
153/153 [==============================] - 0s 543us/step
MSE: 322775551.2487931
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 602us/step
156/156 [==============================] - 0s 533us/step
156/156 [==============================] - 0s 608us/step
MSE: 2771981.899421178
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 571us/step
156/156 [==============================] - 0s 620us/step
156/156 [==============================] - 0s 563us/step
MSE: 3380585.0204950604
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 643us/step
156/156 [==============================] - 0s 576us/step
156/156 [==============================] - 0s 547us/step
MSE: 3518596.1478016535
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 547us/step
156/156 [==============================] - 0s 721us/step
156/156 [==============================] - 0s 630us/step
MSE: 5721079.150212901
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 643us/step
156/156 [==============================] - 0s 531us/step
156/156 [==============================] - 0s 571us/step
MSE: 2747540.434015813
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 552us/step
156/156 [==============================] - 0s 627us/step
MSE: 4409525.057495215
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 630us/step
156/156 [==============================] - 0s 557us/step
MSE: 4130411.3584316536
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 644us/step
156/156 [==============================] - 0s 595us/step
156/156 [==============================] - 0s 630us/step
MSE: 17616389.953567024
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 605us/step
156/156 [==============================] - 0s 552us/step
156/156 [==============================] - 0s 633us/step
MSE: 3880892.5157759474
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 554us/step
156/156 [==============================] - 0s 563us/step
156/156 [==============================] - 0s 546us/step
MSE: 8061310.50350781
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 533us/step
156/156 [==============================] - 0s 564us/step
156/156 [==============================] - 0s 618us/step
MSE: 6003960.217219246
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 557us/step
156/156 [==============================] - 0s 554us/step
156/156 [==============================] - 0s 558us/step
MSE: 55219080.91462622
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 540us/step
156/156 [==============================] - 0s 948us/step
156/156 [==============================] - 0s 534us/step
MSE: 6639771.083159774
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 572us/step
156/156 [==============================] - 0s 573us/step
156/156 [==============================] - 0s 569us/step
MSE: 17127684.40472942
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 562us/step
156/156 [==============================] - 0s 554us/step
156/156 [==============================] - 0s 571us/step
MSE: 32064893.07796852
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 563us/step
156/156 [==============================] - 0s 569us/step
156/156 [==============================] - 0s 569us/step
MSE: 55867942.505997285
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 593us/step
155/155 [==============================] - 0s 647us/step
MSE: 7525118.093628116
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 648us/step
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 643us/step
MSE: 5890719.0524121495
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 522us/step
155/155 [==============================] - 0s 579us/step
155/155 [==============================] - 0s 647us/step
MSE: 6694552.515595019
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 624us/step
155/155 [==============================] - 0s 629us/step
155/155 [==============================] - 0s 634us/step
MSE: 7058624.957310165
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 558us/step
155/155 [==============================] - 0s 625us/step
155/155 [==============================] - 0s 539us/step
MSE: 5097947.529692506
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 556us/step
155/155 [==============================] - 0s 527us/step
155/155 [==============================] - 0s 575us/step
MSE: 6504481.664175243
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 577us/step
155/155 [==============================] - 0s 565us/step
MSE: 8276065.741788647
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 598us/step
155/155 [==============================] - 0s 537us/step
155/155 [==============================] - 0s 586us/step
MSE: 7961013.855447213
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 621us/step
155/155 [==============================] - 0s 556us/step
155/155 [==============================] - 0s 568us/step
MSE: 8574845.691304993
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 621us/step
155/155 [==============================] - 0s 579us/step
155/155 [==============================] - 0s 558us/step
MSE: 11227702.553983834
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 539us/step
155/155 [==============================] - 0s 572us/step
155/155 [==============================] - 0s 550us/step
MSE: 17930483.322926674
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 597us/step
155/155 [==============================] - 0s 643us/step
155/155 [==============================] - 0s 960us/step
MSE: 15510619.234489275
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 554us/step
155/155 [==============================] - 0s 563us/step
155/155 [==============================] - 0s 545us/step
MSE: 32370121.419710927
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 533us/step
155/155 [==============================] - 0s 606us/step
155/155 [==============================] - 0s 574us/step
MSE: 25022641.923472818
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 563us/step
155/155 [==============================] - 0s 600us/step
155/155 [==============================] - 0s 604us/step
MSE: 44940589.10420698
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 563us/step
155/155 [==============================] - 0s 726us/step
155/155 [==============================] - 0s 538us/step
MSE: 87314165.03525774
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 691us/step
154/154 [==============================] - 0s 609us/step
154/154 [==============================] - 0s 579us/step
MSE: 7617593.147489922
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 563us/step
154/154 [==============================] - 0s 540us/step
154/154 [==============================] - 0s 571us/step
MSE: 8181122.589877866
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 543us/step
154/154 [==============================] - 0s 649us/step
154/154 [==============================] - 0s 577us/step
MSE: 10619701.582192322
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 613us/step
154/154 [==============================] - 0s 610us/step
154/154 [==============================] - 0s 564us/step
MSE: 12124879.743004564
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 656us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 727us/step
MSE: 10428706.673126826
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 579us/step
154/154 [==============================] - 0s 528us/step
MSE: 12203426.506891463
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 635us/step
154/154 [==============================] - 0s 602us/step
154/154 [==============================] - 0s 622us/step
MSE: 11570364.403913928
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 616us/step
154/154 [==============================] - 0s 565us/step
154/154 [==============================] - 0s 626us/step
MSE: 10874826.969332162
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 605us/step
154/154 [==============================] - 0s 600us/step
154/154 [==============================] - 0s 617us/step
MSE: 10165854.538649097
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 629us/step
154/154 [==============================] - 0s 636us/step
154/154 [==============================] - 0s 580us/step
MSE: 12451420.056473708
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 603us/step
154/154 [==============================] - 0s 949us/step
154/154 [==============================] - 0s 614us/step
MSE: 22429943.749060668
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 510us/step
154/154 [==============================] - 0s 602us/step
154/154 [==============================] - 0s 632us/step
MSE: 27106799.95390554
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 552us/step
154/154 [==============================] - 0s 631us/step
154/154 [==============================] - 0s 576us/step
MSE: 35935568.95369587
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 634us/step
154/154 [==============================] - 0s 555us/step
154/154 [==============================] - 0s 620us/step
MSE: 38549482.42559808
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 629us/step
154/154 [==============================] - 0s 640us/step
154/154 [==============================] - 0s 553us/step
MSE: 79388742.72334832
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 527us/step
154/154 [==============================] - 0s 602us/step
154/154 [==============================] - 0s 541us/step
MSE: 90635600.25123061
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 570us/step
153/153 [==============================] - 0s 638us/step
153/153 [==============================] - 0s 569us/step
MSE: 11965432.262808066
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 520us/step
153/153 [==============================] - 0s 580us/step
153/153 [==============================] - 0s 560us/step
MSE: 9845509.737787383
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 926us/step
153/153 [==============================] - 0s 688us/step
153/153 [==============================] - 0s 710us/step
MSE: 11245445.011254283
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 681us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 908us/step
MSE: 15401246.885340048
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 656us/step
153/153 [==============================] - 0s 626us/step
153/153 [==============================] - 0s 564us/step
MSE: 9940130.089165544
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 555us/step
153/153 [==============================] - 0s 578us/step
MSE: 13324557.89125496
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 580us/step
153/153 [==============================] - 0s 627us/step
153/153 [==============================] - 0s 654us/step
MSE: 14864893.977475416
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 600us/step
153/153 [==============================] - 0s 643us/step
153/153 [==============================] - 0s 586us/step
MSE: 23518706.92222547
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 633us/step
153/153 [==============================] - 0s 596us/step
153/153 [==============================] - 0s 647us/step
MSE: 13772824.413713036
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 609us/step
153/153 [==============================] - 0s 653us/step
153/153 [==============================] - 0s 617us/step
MSE: 19121052.557253845
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 586us/step
153/153 [==============================] - 0s 611us/step
153/153 [==============================] - 0s 586us/step
MSE: 23021821.144039195
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 621us/step
153/153 [==============================] - 0s 558us/step
153/153 [==============================] - 0s 639us/step
MSE: 36810795.06068927
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 570us/step
153/153 [==============================] - 0s 582us/step
153/153 [==============================] - 0s 627us/step
MSE: 19969955.976540036
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 569us/step
153/153 [==============================] - 0s 587us/step
153/153 [==============================] - 0s 627us/step
MSE: 20757181.08109067
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 656us/step
153/153 [==============================] - 0s 595us/step
153/153 [==============================] - 0s 578us/step
MSE: 62277691.46382314
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 790us/step
153/153 [==============================] - 0s 615us/step
153/153 [==============================] - 0s 583us/step
MSE: 113597629.80063324
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 746us/step
156/156 [==============================] - 0s 740us/step
156/156 [==============================] - 0s 632us/step
MSE: 2652801.0801126217
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 545us/step
156/156 [==============================] - 0s 642us/step
MSE: 2642186.204002728
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 643us/step
156/156 [==============================] - 0s 648us/step
156/156 [==============================] - 0s 607us/step
MSE: 2779637.6263220734
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 566us/step
156/156 [==============================] - 0s 640us/step
156/156 [==============================] - 0s 613us/step
MSE: 3253741.9978228654
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 625us/step
156/156 [==============================] - 0s 609us/step
156/156 [==============================] - 0s 1ms/step
MSE: 2881369.7117314143
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 560us/step
156/156 [==============================] - 0s 640us/step
156/156 [==============================] - 0s 572us/step
MSE: 2841117.9123071856
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 573us/step
156/156 [==============================] - 0s 573us/step
156/156 [==============================] - 0s 620us/step
MSE: 2880318.9930773065
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 568us/step
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 588us/step
MSE: 5686009.04424202
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 611us/step
156/156 [==============================] - 0s 605us/step
156/156 [==============================] - 0s 571us/step
MSE: 3435376.889712154
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1000us/step
156/156 [==============================] - 0s 557us/step
156/156 [==============================] - 0s 943us/step
MSE: 2854316.2441615197
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 627us/step
156/156 [==============================] - 0s 643us/step
156/156 [==============================] - 0s 642us/step
MSE: 3218134.5219609593
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 711us/step
156/156 [==============================] - 0s 763us/step
MSE: 4880207.76596792
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 613us/step
156/156 [==============================] - 0s 571us/step
MSE: 2762700.4122067434
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 625us/step
156/156 [==============================] - 0s 644us/step
156/156 [==============================] - 0s 1ms/step
MSE: 3674940.64121826
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 644us/step
156/156 [==============================] - 0s 642us/step
156/156 [==============================] - 0s 643us/step
MSE: 4016740.638839277
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 626us/step
156/156 [==============================] - 0s 565us/step
156/156 [==============================] - 0s 571us/step
MSE: 9111757.724380268
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 639us/step
155/155 [==============================] - 0s 534us/step
155/155 [==============================] - 0s 646us/step
MSE: 6017010.819921757
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 678us/step
155/155 [==============================] - 0s 620us/step
155/155 [==============================] - 0s 647us/step
MSE: 5457945.488411239
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 617us/step
155/155 [==============================] - 0s 688us/step
155/155 [==============================] - 0s 628us/step
MSE: 5535295.6962358
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 645us/step
155/155 [==============================] - 0s 626us/step
155/155 [==============================] - 0s 687us/step
MSE: 6233385.957341494
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 649us/step
MSE: 4859615.270733806
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 646us/step
155/155 [==============================] - 0s 653us/step
155/155 [==============================] - 0s 625us/step
MSE: 6125328.076501101
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 637us/step
155/155 [==============================] - 0s 608us/step
155/155 [==============================] - 0s 646us/step
MSE: 5220177.217898696
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 647us/step
155/155 [==============================] - 0s 624us/step
155/155 [==============================] - 0s 648us/step
MSE: 5751868.604536115
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 643us/step
155/155 [==============================] - 0s 619us/step
155/155 [==============================] - 0s 979us/step
MSE: 4801922.885586081
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 638us/step
155/155 [==============================] - 0s 549us/step
155/155 [==============================] - 0s 625us/step
MSE: 5557714.720145606
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 647us/step
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 631us/step
MSE: 5656889.290959502
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 661us/step
155/155 [==============================] - 0s 621us/step
155/155 [==============================] - 0s 576us/step
MSE: 5906513.728804602
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 612us/step
155/155 [==============================] - 0s 648us/step
155/155 [==============================] - 0s 629us/step
MSE: 5508000.674678244
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 647us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 647us/step
MSE: 10298460.255905183
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 600us/step
155/155 [==============================] - 0s 644us/step
155/155 [==============================] - 0s 618us/step
MSE: 5545646.304384361
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 538us/step
155/155 [==============================] - 0s 647us/step
155/155 [==============================] - 0s 605us/step
MSE: 6247374.806126848
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 784us/step
154/154 [==============================] - 0s 720us/step
154/154 [==============================] - 0s 805us/step
MSE: 13267419.566906404
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 818us/step
154/154 [==============================] - 0s 755us/step
154/154 [==============================] - 0s 763us/step
MSE: 9929301.266308848
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 747us/step
154/154 [==============================] - 0s 788us/step
154/154 [==============================] - 0s 803us/step
MSE: 7532748.931056028
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 808us/step
154/154 [==============================] - 0s 691us/step
154/154 [==============================] - 0s 796us/step
MSE: 8836268.69857722
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 719us/step
154/154 [==============================] - 0s 797us/step
154/154 [==============================] - 0s 808us/step
MSE: 8334595.521899508
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 779us/step
154/154 [==============================] - 0s 719us/step
154/154 [==============================] - 0s 802us/step
MSE: 7696717.692824274
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 756us/step
154/154 [==============================] - 0s 720us/step
154/154 [==============================] - 0s 776us/step
MSE: 7592379.669142829
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 797us/step
154/154 [==============================] - 0s 798us/step
154/154 [==============================] - 0s 1ms/step
MSE: 8270216.314122538
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 724us/step
154/154 [==============================] - 0s 804us/step
154/154 [==============================] - 0s 712us/step
MSE: 10107981.007903982
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 706us/step
154/154 [==============================] - 0s 761us/step
154/154 [==============================] - 0s 781us/step
MSE: 9235395.89388694
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 754us/step
154/154 [==============================] - 0s 719us/step
154/154 [==============================] - 0s 767us/step
MSE: 7752395.524238171
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 787us/step
154/154 [==============================] - 0s 700us/step
MSE: 8382568.316832985
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 797us/step
154/154 [==============================] - 0s 807us/step
154/154 [==============================] - 0s 713us/step
MSE: 9772203.149260735
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 721us/step
154/154 [==============================] - 0s 779us/step
154/154 [==============================] - 0s 733us/step
MSE: 7794537.297434279
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 742us/step
154/154 [==============================] - 0s 744us/step
MSE: 8058461.236750787
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 792us/step
154/154 [==============================] - 0s 733us/step
154/154 [==============================] - 0s 729us/step
MSE: 8725988.596034333
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 764us/step
153/153 [==============================] - 0s 803us/step
153/153 [==============================] - 0s 683us/step
MSE: 14748663.304454358
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 713us/step
153/153 [==============================] - 0s 738us/step
153/153 [==============================] - 0s 740us/step
MSE: 9218533.265314091
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 799us/step
153/153 [==============================] - 0s 782us/step
153/153 [==============================] - 0s 801us/step
MSE: 9982152.285377353
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 697us/step
153/153 [==============================] - 0s 758us/step
153/153 [==============================] - 0s 1ms/step
MSE: 11737212.183406884
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 761us/step
153/153 [==============================] - 0s 790us/step
153/153 [==============================] - 0s 717us/step
MSE: 10133087.188207895
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 818us/step
153/153 [==============================] - 0s 778us/step
153/153 [==============================] - 0s 770us/step
MSE: 11158037.230132248
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 718us/step
153/153 [==============================] - 0s 814us/step
153/153 [==============================] - 0s 784us/step
MSE: 9678846.399173992
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 802us/step
153/153 [==============================] - 0s 689us/step
153/153 [==============================] - 0s 1ms/step
MSE: 11676729.470733931
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 732us/step
153/153 [==============================] - 0s 802us/step
153/153 [==============================] - 0s 796us/step
MSE: 9361330.87013467
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 797us/step
153/153 [==============================] - 0s 802us/step
153/153 [==============================] - 0s 793us/step
MSE: 9329227.505056774
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 733us/step
153/153 [==============================] - 0s 717us/step
153/153 [==============================] - 0s 790us/step
MSE: 9919380.495284954
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 802us/step
153/153 [==============================] - 0s 844us/step
153/153 [==============================] - 0s 789us/step
MSE: 12929651.546266574
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 700us/step
153/153 [==============================] - 0s 723us/step
153/153 [==============================] - 0s 1ms/step
MSE: 9729067.925617525
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 741us/step
153/153 [==============================] - 0s 794us/step
153/153 [==============================] - 0s 811us/step
MSE: 9311548.281120218
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 787us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 988us/step
MSE: 10417402.458570337
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 922us/step
153/153 [==============================] - 0s 808us/step
153/153 [==============================] - 0s 795us/step
MSE: 12744352.403314065
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 5862872.483641432
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 3102241.3452211213
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2963736.753207782
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2936051.470521234
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 4278346.377083482
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 4172833.3266297155
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 3256549.708328062
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2896813.8224915555
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2825031.7731068055
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2653261.4136749483
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 3106986.6536055575
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2927615.0449989773
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2701140.8671887657
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 3406456.1849682233
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2937044.594406282
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2865946.8835127563
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 4900779.307762889
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5266081.371939251
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5216052.128043787
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 5755652.040813038
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 24711660.60582134
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 7118162.092307768
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5868681.62036083
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 3ms/step
MSE: 5842661.763688293
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5747620.800789057
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5181441.888824184
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5231108.483506371
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 6517500.1422647955
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 5721386.619258484
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 3ms/step
MSE: 5413342.406236955
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 3ms/step
MSE: 5656017.242233722
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 5731082.005705885
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 8128407.306931786
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 6445159.239859473
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 7934131.216346461
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8645422.47094041
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 3ms/step
MSE: 7474073.892813112
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 3ms/step
MSE: 7054972.244560707
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 7106330.82520745
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 8235202.467976419
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 9898945.50116838
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 7615977.59770385
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 7174672.013119942
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 1s 3ms/step
MSE: 7939200.440569525
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 3ms/step
MSE: 7721778.946369974
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 8208543.910298231
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8569150.544060687
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 10456301.204589432
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 8047040.474871024
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 11189015.254208194
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 10363600.936607778
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 10125306.766214253
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 15450205.234994048
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 9093242.849902308
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 8873269.11026408
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 3ms/step
MSE: 12152313.255500594
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 12522066.143360987
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 3ms/step
MSE: 18123179.636977434
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 8719477.251182752
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 1s 3ms/step
MSE: 10536388.04550069
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 17547912.57679718
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 9628390.109152284
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 9136731.189026335
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 10531784.079112677
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_price</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 1000, &#39;batchsize&#39;: 32, &#39;dropout_rate&#39;: 0.2, &#39;horizon&#39;: 7, &#39;window&#39;: 7, &#39;MSE&#39;: 2642186.204002728}
</pre></div>
</div>
</div>
</div>
<p>A diferencia de las RNN redes neuronales recurrentes el modelo mpl es rápido por que permite hacer la optimización con todos los posibles parametros. los mejores resultados fueron con la combinación {‘neurons’: 10000, ‘batchsize’: 32, ‘dropout_rate’: 0.4, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 2633246.2263151007}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="residuales">
<h3>Residuales<a class="headerlink" href="#residuales" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo para su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_price</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.172435
1        2             0.172435
2        3             0.172435
3        4             0.172435
4        5             0.172435
5        6             0.172435
6        7             0.172435
7        8             0.172435
8        9             0.172435
9       10             0.172435
</pre></div>
</div>
<img alt="_images/5c1525b73debcc9a437862d3b5eebd7fe24add36884bbd020ffabef6d77dffad.png" src="_images/5c1525b73debcc9a437862d3b5eebd7fe24add36884bbd020ffabef6d77dffad.png" />
<img alt="_images/07b32b4fca2792466282870d6da745af00cb2ad10de4c8a8c4dd922ca8fdadae.png" src="_images/07b32b4fca2792466282870d6da745af00cb2ad10de4c8a8c4dd922ca8fdadae.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_15068\1560686776.py:34: MatplotlibDeprecationWarning: The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
  plt.stem(range(len(acf_vals)), acf_vals, use_line_collection=True)
</pre></div>
</div>
<img alt="_images/358a072db00d910c4ba56633eedc595ace222d0e2bf05549f4fbc83b7514233c.png" src="_images/358a072db00d910c4ba56633eedc595ace222d0e2bf05549f4fbc83b7514233c.png" />
<img alt="_images/47b7c9dac7d6985cb2bd16420af9f5bad6df52f41004c13af084a4d701082bc0.png" src="_images/47b7c9dac7d6985cb2bd16420af9f5bad6df52f41004c13af084a4d701082bc0.png" />
<img alt="_images/36831a45e2881210d581c629ed204634eba0b2ce588286ec6edb4ef81e1af755.png" src="_images/36831a45e2881210d581c629ed204634eba0b2ce588286ec6edb4ef81e1af755.png" />
<img alt="_images/6a27788aee87ff81a555c4ed3f5e37f2820804d7e2c81d4917b91f74221ebc1d.png" src="_images/6a27788aee87ff81a555c4ed3f5e37f2820804d7e2c81d4917b91f74221ebc1d.png" />
<img alt="_images/6b9caec005b3a78a9e0427abac63cd14f5d511f62e234d61339c69191b46e05b.png" src="_images/6b9caec005b3a78a9e0427abac63cd14f5d511f62e234d61339c69191b46e05b.png" />
<img alt="_images/c45a622ac2c64eb7d6263caddcfbdf32c7f8df776885126fe111b29a39365cf1.png" src="_images/c45a622ac2c64eb7d6263caddcfbdf32c7f8df776885126fe111b29a39365cf1.png" />
<img alt="_images/32c6430ba3e0f423ace9b3eaf8d05b4847cdf43707eca6916abaa3de9424de4b.png" src="_images/32c6430ba3e0f423ace9b3eaf8d05b4847cdf43707eca6916abaa3de9424de4b.png" />
<img alt="_images/0a3441e90f39d8d54efbb1bf519695098f8dca00340a4cdd83f200c7240068f6.png" src="_images/0a3441e90f39d8d54efbb1bf519695098f8dca00340a4cdd83f200c7240068f6.png" />
<img alt="_images/6d3981553dd370be40baa4b9285b6894f8399d9a7e0833457705b69b13648184.png" src="_images/6d3981553dd370be40baa4b9285b6894f8399d9a7e0833457705b69b13648184.png" />
<img alt="_images/d1433d8a7280906abd9d114caee6b22b290c70228f4a5f4e88e76df8a94d9523.png" src="_images/d1433d8a7280906abd9d114caee6b22b290c70228f4a5f4e88e76df8a94d9523.png" />
<img alt="_images/55b74d0162d834042b6e28e0ec4972cf2a80704ea5170429133df40b10600658.png" src="_images/55b74d0162d834042b6e28e0ec4972cf2a80704ea5170429133df40b10600658.png" />
<img alt="_images/497dc4281bdcc8a501972154fdadd4de1c673aae150508963977821bcbec2d92.png" src="_images/497dc4281bdcc8a501972154fdadd4de1c673aae150508963977821bcbec2d92.png" />
<img alt="_images/1be8732e47e25e37c146b90733682df8bbcd837931211b6e3a1304c7d51a9f5e.png" src="_images/1be8732e47e25e37c146b90733682df8bbcd837931211b6e3a1304c7d51a9f5e.png" />
</div>
</div>
<p>De los residuales podemos secir que no cumplen cumplen, no distribuyen normal, tienen asimetria, además no son independientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_price</span>  <span class="c1"># Lista que contiene los diccionarios</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neurons</th>
      <th>batchsize</th>
      <th>Dropout</th>
      <th>horizon</th>
      <th>window</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>16</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>26.677145</td>
      <td>2447.209815</td>
      <td>2.976960e+07</td>
      <td>5456.152133</td>
      <td>0.879194</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>32</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>65.144377</td>
      <td>7043.162041</td>
      <td>2.370908e+08</td>
      <td>15397.751651</td>
      <td>0.036452</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>64</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>94.279439</td>
      <td>10289.630920</td>
      <td>4.379187e+08</td>
      <td>20926.507878</td>
      <td>-0.776610</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>128</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>63.607295</td>
      <td>6893.158399</td>
      <td>2.111453e+08</td>
      <td>14530.841238</td>
      <td>0.146865</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>16</td>
      <td>0.4</td>
      <td>7</td>
      <td>7</td>
      <td>32.619640</td>
      <td>3057.335311</td>
      <td>3.244810e+07</td>
      <td>5696.323773</td>
      <td>0.868695</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>10000</td>
      <td>128</td>
      <td>0.6</td>
      <td>28</td>
      <td>28</td>
      <td>17.584368</td>
      <td>1470.991982</td>
      <td>1.053639e+07</td>
      <td>3245.980290</td>
      <td>0.955280</td>
    </tr>
    <tr>
      <th>252</th>
      <td>10000</td>
      <td>16</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>21.868592</td>
      <td>2018.129223</td>
      <td>1.754791e+07</td>
      <td>4189.022867</td>
      <td>0.925462</td>
    </tr>
    <tr>
      <th>253</th>
      <td>10000</td>
      <td>32</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>17.072868</td>
      <td>1383.329541</td>
      <td>9.628390e+06</td>
      <td>3102.964729</td>
      <td>0.959156</td>
    </tr>
    <tr>
      <th>254</th>
      <td>10000</td>
      <td>64</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>16.478765</td>
      <td>1335.401147</td>
      <td>9.136731e+06</td>
      <td>3022.702630</td>
      <td>0.961250</td>
    </tr>
    <tr>
      <th>255</th>
      <td>10000</td>
      <td>128</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>17.570224</td>
      <td>1470.644903</td>
      <td>1.053178e+07</td>
      <td>3245.271033</td>
      <td>0.955303</td>
    </tr>
  </tbody>
</table>
<p>256 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En esta figura podemos observar el MSE a lo largo de las iteraciones, vemos que a medida que se aumnetaron las neuronas el resultado mejoraba. Además delemitar la busqueda a partir de los parametros que ya se sabía que tenian buen desempeño permitió estabilizar la metrica.</p>
</section>
<section id="boxplot">
<h4>Boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h4>
<p>Ahora compararemos los errores en el entrenamiento, prueba y test con la metrica mape porque esta representa los errores de manera porcentual</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_price</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_price</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
        
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre 3 Listas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5711e44d2ba01997664a7a97e2431621b6f3c2477570844c6faf2db93f131803.png" src="_images/5711e44d2ba01997664a7a97e2431621b6f3c2477570844c6faf2db93f131803.png" />
</div>
</div>
<p>Las medianas son similares al igual que los las cajas porque al manejar la metodología de ventanas deslizantes los conjuntos son iguales a excepción de la primera y ultima ventana. sin embargo las medianas se van reduciendo porque el modelo aprende luego de evaluar el conjunto de validación, reajuste del modelo.</p>
<p>Los puntos por fuera de las cajas implican que el modelo suavizó picos o fluctuaciones atípicas</p>
</section>
</section>
<section id="prediciones">
<h3>Prediciones<a class="headerlink" href="#prediciones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_price</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 788us/step
156/156 [==============================] - 0s 638us/step
</pre></div>
</div>
</div>
</div>
<p>Aquí podemos ver la predicción de las ventanas para entrenamiento de manera independiente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En la grafica se puede los horizones de predicción para cada ventana. el conjunto de train es igual al de validación sin embargo la prueba se mantiene con diferencia</p>
</section>
</section>
<section id="serie-change">
<h2>Serie Change%<a class="headerlink" href="#serie-change" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Crear el objeto escalador</span>

<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Change %&#39;</span><span class="p">]</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Escala los datos</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Para esta serie se hizo una modificación especial, no solo se esscalaron los datos sino que se les sumó 1 para evitar tener errores por valores en 0, a la hora de calcular las métricas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

<span class="n">validation_metrics_ch</span><span class="p">,</span><span class="n">test_metrics_ch</span><span class="p">,</span><span class="n">train_metrics_ch</span><span class="p">,</span><span class="n">residual_hist_ch</span><span class="p">,</span><span class="n">best_model_ch</span><span class="p">,</span><span class="n">params_best_model_ch</span><span class="p">,</span><span class="n">residuals_bestmodel_ch</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.05909333935263944
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.2603373231986953
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 1.585581443658808
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 732us/step
156/156 [==============================] - 0s 750us/step
MSE: 2.694763131293776
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 897us/step
156/156 [==============================] - 0s 789us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.11707063148044801
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.18169854365926572
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 809us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 876us/step
MSE: 1.4094751999069142
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 713us/step
156/156 [==============================] - 0s 909us/step
MSE: 1.0748297423357818
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.3557188360662237
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.16415542811893377
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.48910141179130967
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2.2698201553007777
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.5858055767394375
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.9277551401435231
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.9296184741353771
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 1.1588583502262892
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.14562896076384765
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.20575152729131863
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8889067829101013
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.134874881366996
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.06641258880683314
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.4774838644393618
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8425464859420897
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.9294105397158471
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.23459046406210698
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8299700210332155
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.7792468059543686
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.0051601178090948
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.5196609545241472
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 746us/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8045533632829479
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.1014093036196981
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.0365338758644698
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.020475501242033886
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.5570772186906672
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.4882667506099902
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.756367356412222
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.23821268290252512
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.2954332170241732
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.43658367224832034
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.4335227890149538
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.28720976103821105
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.5749819040116433
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.8402441818368778
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.065603378993418
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.4321762736247414
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.6165282940222847
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.837118419459125
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.1335659716110567
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.06058725275347169
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 749us/step
MSE: 0.1280621877360646
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 681us/step
153/153 [==============================] - 0s 514us/step
153/153 [==============================] - 0s 521us/step
MSE: 0.47272553867208067
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 877us/step
153/153 [==============================] - 0s 538us/step
153/153 [==============================] - 0s 594us/step
MSE: 1.1987120574732686
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 769us/step
153/153 [==============================] - 0s 604us/step
153/153 [==============================] - 0s 904us/step
MSE: 0.03599137912537855
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 562us/step
153/153 [==============================] - 0s 696us/step
153/153 [==============================] - 0s 616us/step
MSE: 0.16845616613133013
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 708us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 695us/step
MSE: 0.6944793691431422
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 712us/step
153/153 [==============================] - 0s 872us/step
153/153 [==============================] - 0s 916us/step
MSE: 1.0876476253552478
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 733us/step
153/153 [==============================] - 0s 805us/step
153/153 [==============================] - 0s 555us/step
MSE: 0.3545260101881773
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.5843964842890695
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 520us/step
153/153 [==============================] - 0s 518us/step
153/153 [==============================] - 0s 520us/step
MSE: 0.7051448479254782
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 435us/step
153/153 [==============================] - 0s 651us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.9340359174246949
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 522us/step
MSE: 0.4203256566766652
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 539us/step
153/153 [==============================] - 0s 535us/step
153/153 [==============================] - 0s 543us/step
MSE: 0.88684618463601
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 561us/step
153/153 [==============================] - 0s 536us/step
153/153 [==============================] - 0s 556us/step
MSE: 0.9504739088165374
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 530us/step
153/153 [==============================] - 0s 515us/step
153/153 [==============================] - 0s 540us/step
MSE: 1.13661710733869
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 560us/step
156/156 [==============================] - 0s 874us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0008149540587435323
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0005950647201244154
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.001302999286123678
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.01447780438915251
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0014771066077113864
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.005051116766987247
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0038161086126692312
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.010669408940149231
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0026844096321119843
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 916us/step
156/156 [==============================] - 0s 949us/step
MSE: 0.014955870571627644
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.014259012124758283
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.012810075375399322
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.03642754675877936
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.04422030229844902
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.09635294106866474
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.395979049566752
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 955us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.000603416143070798
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0010948853760779672
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0034553619895939377
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.003925842455439333
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.005418839472955081
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.005807255728955918
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.014578707945828565
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.01748402033871611
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 739us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.00922264983174165
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.015271885249447734
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.04232051665807563
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.05405560537981136
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.028414007666050217
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.07439274091311719
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.12030871123497908
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.202470073006523
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0018437631135278317
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 965us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0022412706096054916
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 752us/step
154/154 [==============================] - 0s 763us/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.00430965652414995
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.028091829259529917
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.002929374989313192
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.005329248754607484
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.011474805165610296
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 981us/step
154/154 [==============================] - 0s 798us/step
MSE: 0.015834333218971163
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 987us/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.01424876468888499
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 816us/step
MSE: 0.018786137655609863
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.04568823972387753
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0890146786555277
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.023407950519256232
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.09185527319957458
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.16834724589319983
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.3689010857619136
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 890us/step
153/153 [==============================] - 0s 719us/step
MSE: 0.002751284590271814
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0017061094108474235
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0030689954584778513
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.009761910208594895
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0027492990529228204
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 657us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.006391718254742972
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 746us/step
MSE: 0.015546035526448157
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 490us/step
153/153 [==============================] - 0s 514us/step
153/153 [==============================] - 0s 619us/step
MSE: 0.03742347536073782
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 824us/step
153/153 [==============================] - 0s 596us/step
153/153 [==============================] - 0s 586us/step
MSE: 0.005086496657134215
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 827us/step
153/153 [==============================] - 0s 518us/step
153/153 [==============================] - 0s 834us/step
MSE: 0.022089037449350226
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 726us/step
153/153 [==============================] - 0s 732us/step
153/153 [==============================] - 0s 731us/step
MSE: 0.05814359964685127
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 625us/step
153/153 [==============================] - 0s 710us/step
153/153 [==============================] - 0s 627us/step
MSE: 0.10037668338037349
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 973us/step
153/153 [==============================] - 0s 619us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.04103788709356959
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 987us/step
153/153 [==============================] - 0s 758us/step
MSE: 0.06954406535247447
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 619us/step
153/153 [==============================] - 0s 513us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.1675724684043114
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 837us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 728us/step
MSE: 0.2872479591026975
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0006305667861343768
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005860999245378207
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005696227415473295
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.004530010229346606
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00040908610882465314
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005564332782344192
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0004811647088058412
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.004855645529780191
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0006047629459960263
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00043026142355265067
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00048249996527327435
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.005580763071722782
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.004760998706987854
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0025421914705675156
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005936739859838157
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.014402357321590977
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 863us/step
155/155 [==============================] - 0s 991us/step
MSE: 0.0005817072185295231
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0004937463066879164
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.00044282283249658615
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 964us/step
MSE: 0.0032473460669705098
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0012163975095008995
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0010333525735375401
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0005261728545994399
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 819us/step
MSE: 0.003696783165971693
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.00041142009566595526
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0005089093951831345
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 959us/step
MSE: 0.0012458478307928126
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0021329132832305737
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.000748449524192817
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 645us/step
155/155 [==============================] - 0s 818us/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.000832343802311448
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.003985209370276998
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0021484611368109284
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005588286385860701
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005099567065679157
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0005234638583973784
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0036816672166264212
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0014198637337889657
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005858281468757587
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0006908594842930826
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0020011213417978
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0005201668521378033
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0007530737237727457
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0009982917847477484
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0011989854855535879
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0009727966657284218
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0012199221520393657
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0018389753755645934
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.006393428835348022
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.000701624886544609
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0004987736561434299
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0005061459783041607
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.003897810723216911
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 0.0010055153985089173
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.001021447942112288
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0008227292597228723
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.004533845316596562
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0008468969494590475
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0016091862660989693
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0036446327483641893
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.007364902540837856
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.002733067729610185
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0007355484163858131
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0014994853568367713
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.011954527430312445
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0007573890768965194
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00041850456496750343
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00036826683431922077
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.001157957460067669
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00043731816202246523
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00038134200338956723
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00041280297554316094
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0013569057296025262
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0009053758008410619
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0005035220553292795
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0004759535046763773
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.001583823241089873
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0019690534609987397
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 0.0006956003280096363
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00047990112057633226
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0005284445150715303
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0004275805584862488
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003771401907635318
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00038254844948481327
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0008675351525780169
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0006833534021959823
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00047300162289451816
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003987081400217102
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0008161562346266465
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0007466526176314567
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 6ms/step
MSE: 0.0005813870237274661
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.000507905806912303
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0014005702562881939
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0005244703878228604
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0006375122281961955
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0004701969076149264
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0010445468528638407
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004936620476859692
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 0.000400488248600201
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0003843512267153489
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0032853986594356915
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0006489105436979922
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0005666743703820801
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00043059487534783677
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.003419553670142277
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0006298715066630178
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004721515143130168
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004707812546811508
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 0.004743911302144779
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0022460897073498074
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00043261384662724947
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00044883248126937854
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0038225561407594848
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0004211485735100257
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0003869893469859229
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0003986801950501384
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0008473948937455369
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.002751524354216895
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0005916540776832036
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.00043575577174560857
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0012505119356782655
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0037812866589783255
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0007117148854117376
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0005002867473626199
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0011742146739582744
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.007636879226682763
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.003560590891819835
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0008218893843505753
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0005851265808891014
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_ch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 10000, &#39;batchsize&#39;: 64, &#39;dropout_rate&#39;: 0.2, &#39;horizon&#39;: 7, &#39;window&#39;: 7, &#39;MSE&#39;: 0.00036826683431922077}
</pre></div>
</div>
</div>
</div>
<p>Los mejores parametros para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> fueron:
{‘neurons’: 10000, ‘batchsize’: 64, ‘dropout_rate’: 0.2, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 0.00036826683431922077}. De las series analizadas podemos decir que 10000 neuronas y ventanas de 7 valores entregan mejores resultados</p>
<section id="id1">
<h3>Residuales<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo  para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_ch</span>


<span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.460332
1        2             0.460332
2        3             0.460332
3        4             0.460332
4        5             0.460332
5        6             0.460332
6        7             0.460332
7        8             0.460332
8        9             0.460332
9       10             0.460332
</pre></div>
</div>
<img alt="_images/9034b80de9a5adbed3ef8909663b8aac1ee41d04503ce3fb3f754253d5413415.png" src="_images/9034b80de9a5adbed3ef8909663b8aac1ee41d04503ce3fb3f754253d5413415.png" />
<img alt="_images/893714ce63a6620adefa1f8f0fe3baf670aa71fa51fa7d55238df218710c3b98.png" src="_images/893714ce63a6620adefa1f8f0fe3baf670aa71fa51fa7d55238df218710c3b98.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_24768\3775612513.py:37: MatplotlibDeprecationWarning: The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
  plt.stem(range(len(acf_vals)), acf_vals, use_line_collection=True)
</pre></div>
</div>
<img alt="_images/5503e46c423940d0cd40f13808b12cc9878e658d0d360b9f67893d57d407cf75.png" src="_images/5503e46c423940d0cd40f13808b12cc9878e658d0d360b9f67893d57d407cf75.png" />
<img alt="_images/a6398deb84d0130852d20da7589bcb37a6c636c8159e2c18fd88c3be12366c1c.png" src="_images/a6398deb84d0130852d20da7589bcb37a6c636c8159e2c18fd88c3be12366c1c.png" />
<img alt="_images/b32ffab6e691fe930e2909c613a8d85982a1826338fa961e39486e896b07b64e.png" src="_images/b32ffab6e691fe930e2909c613a8d85982a1826338fa961e39486e896b07b64e.png" />
<img alt="_images/eca1b7a0da55b3bc09e92d2df84ffb4e82bcc8f36b28167cf856c3dfe3f7531c.png" src="_images/eca1b7a0da55b3bc09e92d2df84ffb4e82bcc8f36b28167cf856c3dfe3f7531c.png" />
<img alt="_images/3d1c312ec0d8f689111bcf66efda142f7d4eb730a97b9c2205acf2e62ba2f2d8.png" src="_images/3d1c312ec0d8f689111bcf66efda142f7d4eb730a97b9c2205acf2e62ba2f2d8.png" />
<img alt="_images/23abe14fd0a6dc184ad47b791bfc45c3ebc5faa9e46dc44aee4ab8025959a36f.png" src="_images/23abe14fd0a6dc184ad47b791bfc45c3ebc5faa9e46dc44aee4ab8025959a36f.png" />
<img alt="_images/97aafa1fb3664ff0f8acef9c734765ebc04f0340a85d06a05ca7b875c6d888e6.png" src="_images/97aafa1fb3664ff0f8acef9c734765ebc04f0340a85d06a05ca7b875c6d888e6.png" />
<img alt="_images/e78f96952d471a18bc6d1e4057338ac8994290e62c5c8ab9ec236e7964b6fdc9.png" src="_images/e78f96952d471a18bc6d1e4057338ac8994290e62c5c8ab9ec236e7964b6fdc9.png" />
<img alt="_images/c7b9793c9505f966e715527791169b4fccecb8af8e50344f7cf1c9062f148b5f.png" src="_images/c7b9793c9505f966e715527791169b4fccecb8af8e50344f7cf1c9062f148b5f.png" />
<img alt="_images/435ca42f3b52ed8ddb1890c344d117c7c3f230fb68b35a6a3c6cbc0e69a39fda.png" src="_images/435ca42f3b52ed8ddb1890c344d117c7c3f230fb68b35a6a3c6cbc0e69a39fda.png" />
<img alt="_images/777d1b0d2149156b8edd4e1fc0cc93f6efcb868b456cfb2691642b98961249dc.png" src="_images/777d1b0d2149156b8edd4e1fc0cc93f6efcb868b456cfb2691642b98961249dc.png" />
<img alt="_images/1c556819c2f25b3fd5672cce1842ac1a5a92ba7fcaad33b5a12c9ff95664680d.png" src="_images/1c556819c2f25b3fd5672cce1842ac1a5a92ba7fcaad33b5a12c9ff95664680d.png" />
<img alt="_images/cb56bb37860fd2718128fa8aa8046aa2d5a6d23c0858ae75bbbe32e252637c06.png" src="_images/cb56bb37860fd2718128fa8aa8046aa2d5a6d23c0858ae75bbbe32e252637c06.png" />
</div>
</div>
<p>Los residuales no cumplen con los supuestos al igual que en la serie price eso puede deberse al sobre ajuste del modelo</p>
<section id="id2">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_ch</span>  
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neurons</th>
      <th>batchsize</th>
      <th>Dropout</th>
      <th>horizon</th>
      <th>window</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>16</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>15.617120</td>
      <td>0.179193</td>
      <td>0.059093</td>
      <td>0.243091</td>
      <td>-180.511995</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>32</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>37.880822</td>
      <td>0.434304</td>
      <td>0.260337</td>
      <td>0.510233</td>
      <td>-798.659770</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>64</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>96.673118</td>
      <td>1.108118</td>
      <td>1.585581</td>
      <td>1.259199</td>
      <td>-4869.996929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>128</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>109.988278</td>
      <td>1.260652</td>
      <td>2.694763</td>
      <td>1.641573</td>
      <td>-8276.692689</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>16</td>
      <td>0.4</td>
      <td>7</td>
      <td>7</td>
      <td>28.624058</td>
      <td>0.328263</td>
      <td>0.117071</td>
      <td>0.342156</td>
      <td>-358.632929</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>10000</td>
      <td>128</td>
      <td>0.6</td>
      <td>28</td>
      <td>28</td>
      <td>2.328856</td>
      <td>0.026710</td>
      <td>0.001174</td>
      <td>0.034267</td>
      <td>-2.551069</td>
    </tr>
    <tr>
      <th>252</th>
      <td>10000</td>
      <td>16</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>7.396625</td>
      <td>0.084988</td>
      <td>0.007637</td>
      <td>0.087389</td>
      <td>-22.094984</td>
    </tr>
    <tr>
      <th>253</th>
      <td>10000</td>
      <td>32</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>4.850389</td>
      <td>0.055796</td>
      <td>0.003561</td>
      <td>0.059671</td>
      <td>-9.767633</td>
    </tr>
    <tr>
      <th>254</th>
      <td>10000</td>
      <td>64</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>1.837308</td>
      <td>0.021211</td>
      <td>0.000822</td>
      <td>0.028669</td>
      <td>-1.485493</td>
    </tr>
    <tr>
      <th>255</th>
      <td>10000</td>
      <td>128</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>1.413651</td>
      <td>0.016301</td>
      <td>0.000585</td>
      <td>0.024189</td>
      <td>-0.769486</td>
    </tr>
  </tbody>
</table>
<p>256 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>De la grafica de MSE vs la iteración del modelo podemos ver que a medida que se aumentan las neuronas ( que fueron el búcle más grande) el modelo tiene mejores metricas pero esto también puede implicar sobre ajuste del modelo</p>
</section>
<section id="id3">
<h4>Boxplot<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_ch</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_ch</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre train, test, validation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" src="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" />
</div>
</div>
<p>La medianas se ven similares, incluso se logra ver que las casjas son iguales. Por lo que se puede afirmar que el modelo tuvo un comportamiento constante. como los puntos por fuera de las cajas son similares señala que los datos eran atípicos y no son un error del modelo.</p>
</section>
</section>
<section id="id4">
<h3>Prediciones<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_ch</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datos</span><span class="p">):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Como se ve en la gráfica el modelo es capaz de identificar las tendencias y la serie en general a excepción de los picos abrutos.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ejercicio2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Modelos estadísticos</p>
      </div>
    </a>
    <a class="right-next"
       href="RNN.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MODELO RNN</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johana y Claudia
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>