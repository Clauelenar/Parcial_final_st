
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MODELO MLP &#8212; Parcial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MPL';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Parcial</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial Series de tiempo
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio1.html">Parcial 1 de Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ejercicio2.html">Modelos estadísticos</a></li>



<li class="toctree-l1"><a class="reference internal" href="RNN.html">MODELO RNN</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MPL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MODELO MLP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelo-mlp">
<h1>MODELO MLP<a class="headerlink" href="#modelo-mlp" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
<section id="datos">
<h2>Datos<a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\claud\Downloads\Bitcoin Historical Data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Vol.</th>
      <th>Change %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03/24/2024</td>
      <td>67,211.9</td>
      <td>64,036.5</td>
      <td>67,587.8</td>
      <td>63,812.9</td>
      <td>65.59K</td>
      <td>4.96%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03/23/2024</td>
      <td>64,037.8</td>
      <td>63,785.6</td>
      <td>65,972.4</td>
      <td>63,074.9</td>
      <td>35.11K</td>
      <td>0.40%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03/22/2024</td>
      <td>63,785.5</td>
      <td>65,501.5</td>
      <td>66,633.3</td>
      <td>62,328.3</td>
      <td>72.43K</td>
      <td>-2.62%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03/21/2024</td>
      <td>65,503.8</td>
      <td>67,860.0</td>
      <td>68,161.7</td>
      <td>64,616.1</td>
      <td>75.26K</td>
      <td>-3.46%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03/20/2024</td>
      <td>67,854.0</td>
      <td>62,046.8</td>
      <td>68,029.5</td>
      <td>60,850.9</td>
      <td>133.53K</td>
      <td>9.35%</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4994</th>
      <td>07/22/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>2.16K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4995</th>
      <td>07/21/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.58K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>07/20/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.26K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>07/19/2010</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.57K</td>
      <td>0.00%</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>07/18/2010</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.08K</td>
      <td>0.00%</td>
    </tr>
  </tbody>
</table>
<p>4999 rows × 7 columns</p>
</div></div></div>
</div>
<p>Para que los datos estén en el formato correcto se les aplicará el siguiente proceso de eliminación de formatos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar comas y convertir las columnas relevantes a float</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="c1"># Función para convertir valores con &#39;K&#39;, &#39;M&#39;, &#39;B&#39; o números directos</span>
<span class="k">def</span> <span class="nf">convert_volume</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="c1"># Verificar si el valor ya es numérico</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>  <span class="c1"># Devolver el valor si ya es numérico</span>
    <span class="k">elif</span> <span class="s1">&#39;K&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000</span>
    <span class="k">elif</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000</span>
    <span class="k">elif</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1_000_000_000</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="c1"># Aplicar la función a la columna &#39;Vol.&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_volume</span><span class="p">)</span>

<span class="c1"># Verificar que la conversión haya sido exitosa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Vol.
0   65590.0
1   35110.0
2   72430.0
3   75260.0
4  133530.0
</pre></div>
</div>
</div>
</div>
<p>Se verifica el formato de la fecha y se agrega la columnna indice</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegurarse de que la columna &quot;Date&quot; sea de tipo datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span>
<span class="c1"># Ordenar los datos por fecha de forma ascendente</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Verificar si hay valores nulos en cada columna</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="c1"># Alternativa: Mostrar las filas que contengan valores faltantes</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filas con datos faltantes:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Asegúrate de que la columna &#39;Date&#39; esté en formato datetime</span>

<span class="c1"># Convertir la fecha a un timestamp (número de días desde Epoch)</span>

<span class="c1"># Ver las primeras filas con la nueva columna numérica</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;indice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date        0
Price       0
Open        0
High        0
Low         0
Vol.        6
Change %    0
dtype: int64
Filas con datos faltantes:
          Date  Price  Open  High   Low  Vol. Change %
337 2011-06-20   17.5  17.5  17.5  17.5   NaN    0.00%
338 2011-06-21   17.5  17.5  17.5  17.5   NaN    0.00%
339 2011-06-22   17.5  17.5  17.5  17.5   NaN    0.00%
340 2011-06-23   17.5  17.5  17.5  17.5   NaN    0.00%
341 2011-06-24   17.5  17.5  17.5  17.5   NaN    0.00%
342 2011-06-25   17.5  17.5  17.5  17.5   NaN    0.00%
</pre></div>
</div>
</div>
</div>
</section>
<section id="funciones">
<h2>Funciones<a class="headerlink" href="#funciones" title="Link to this heading">#</a></h2>
<section id="ventanas-deslizantes">
<h3>Ventanas deslizantes<a class="headerlink" href="#ventanas-deslizantes" title="Link to this heading">#</a></h3>
<p>Para esto creamos una función que divide los datos en entrenamiento, validación y prueba. Esta función avanca con un paso de 1. las ventanas y el horizonte de predicción son variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">create_sliding_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1"># Generar ventanas deslizantes con sus índices correspondientes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Entrenamiento</span>
        <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
        <span class="n">Y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Validación</span>
        <span class="n">X_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

        <span class="c1"># Prueba</span>
        <span class="n">X_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>
        <span class="n">Y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">])</span>

    <span class="c1"># Convertir a arrays de NumPy</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># (n_samples, window_size)</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">Y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>  <span class="c1"># (n_samples, horizon)</span>
    <span class="n">Y_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_val</span><span class="p">)</span>
    <span class="n">Y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>

    <span class="c1"># Asegurarse de que los datos están en la forma adecuada para MLP (n_samples, n_features)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>  <span class="c1"># Eliminar dimensión extra</span>
    <span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">window_size</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo">
<h3>Construcción del Modelo<a class="headerlink" href="#construccion-del-modelo" title="Link to this heading">#</a></h3>
<p>Creamos una función para crear el modelo teniendo en cuenta los parametros de las iteraciones neurons, window, dropout_rate, horizon. Batch size se aplicará más adelante</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Input</span>

<span class="k">def</span> <span class="nf">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">window</span><span class="p">,)))</span> 
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">horizon</span><span class="p">))</span>  
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">q_stat</span><span class="p">,</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metricas">
<h3>Métricas<a class="headerlink" href="#metricas" title="Link to this heading">#</a></h3>
<p>Creamos una función que calcule las metricas importantes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">metricas</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    
    <span class="c1"># Calcular métricas en Validación</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Advertencia: Las predicciones contienen NaN.&quot;</span><span class="p">)</span>
        <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">windows</span> <span class="o">-</span> <span class="n">pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">windows</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>

        
        <span class="c1"># Guardar métricas del conjunto de validación junto con pruebas de hipótesis</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
            <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
            <span class="s1">&#39;Dropout&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
            <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
            <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span><span class="p">,</span> <span class="n">q_stat</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="funcion-de-optimizacion">
<h3>Función de optimización<a class="headerlink" href="#funcion-de-optimizacion" title="Link to this heading">#</a></h3>
<p>se creo una función con la cual se itera entre todas las posibles combinaciones de paramtros. Se tiene en cuenta el early stoping y la estabilización de la metrica mse para encontar el mejor modelo. luego de que el mse no varie más del 5% 5 iteraciones seguidas se detiene. Además se guardan los residuos y metricas de cada modelo para su posterior uso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">busqueda</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">windows</span><span class="p">,</span> <span class="n">horizons</span><span class="p">,</span> <span class="n">dropout_rates</span><span class="p">,</span> <span class="n">batchsizes</span><span class="p">,</span> <span class="n">neurons_list</span><span class="p">):</span>
    <span class="n">validation_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">train_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">residual_hist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">best_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> 
    <span class="n">previous_mse</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Para rastrear el MSE de la iteración anterior</span>
    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Contador para rastrear iteraciones estables</span>

    <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">neurons</span> <span class="ow">in</span> <span class="n">neurons_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">horizon</span> <span class="ow">in</span> <span class="n">horizons</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="n">horizon</span><span class="p">:</span>
                    <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_sliding_windows</span><span class="p">(</span>
                        <span class="n">datos</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">dropout_rate</span> <span class="ow">in</span> <span class="n">dropout_rates</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">batchsize</span> <span class="ow">in</span> <span class="n">batchsizes</span><span class="p">:</span>

                            <span class="c1"># Crear y entrenar el modelo</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entrenando modelo con </span><span class="si">{</span><span class="n">neurons</span><span class="si">}</span><span class="s2"> neuronas, dropout </span><span class="si">{</span><span class="n">dropout_rate</span><span class="si">}</span><span class="s2">, &quot;</span>
                                  <span class="sa">f</span><span class="s2">&quot;batch size </span><span class="si">{</span><span class="n">batchsize</span><span class="si">}</span><span class="s2">, horizon </span><span class="si">{</span><span class="n">horizon</span><span class="si">}</span><span class="s2">, window </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">model</span> <span class="o">=</span> <span class="n">build_mlp_model</span><span class="p">(</span><span class="n">neurons</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>

                            <span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span>
                                <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                            <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                                <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
                                <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">],</span>
                                <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span>
                            <span class="p">)</span>

                            <span class="c1"># Predicciones y cálculo de residuos</span>
                            <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
                            <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
                            <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>

                            <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_val</span> <span class="o">-</span> <span class="n">val_pred</span>  <span class="c1"># Residuos de validación</span>
                            <span class="n">residual_hist</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                                <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                <span class="s1">&#39;residuals&#39;</span><span class="p">:</span> <span class="n">residuals</span>
                            <span class="p">})</span>

                            <span class="c1"># Calcular métricas en validación</span>
                            
                            <span class="n">metricas_val</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">val_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">validation_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_val</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en prueba</span>
                            <span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">test_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>

                            <span class="c1"># Calcular métricas en entrenamiento</span>
                            <span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">batchsize</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
                            <span class="n">train_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">metricas_val</span><span class="p">:</span>
                                <span class="n">mse</span> <span class="o">=</span> <span class="n">metricas_val</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="c1"># Verificar la fluctuación del MSE</span>
                                <span class="k">if</span> <span class="n">previous_mse</span><span class="p">:</span>
                                    <span class="n">variation</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mse</span> <span class="o">-</span> <span class="n">previous_mse</span><span class="p">)</span> <span class="o">/</span> <span class="n">previous_mse</span>
                                    <span class="k">if</span> <span class="n">variation</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">+=</span> <span class="mi">1</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fluctuación menor al 5% en el MSE por </span><span class="si">{</span><span class="n">stable_iterations</span><span class="si">}</span><span class="s2"> iteración(es).&quot;</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">stable_iterations</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Reiniciar contador si hay variación mayor al 5%</span>

                                    <span class="k">if</span> <span class="n">stable_iterations</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fluctuación menor al 5</span><span class="si">% d</span><span class="s2">urante 5 iteraciones consecutivas. Deteniendo la búsqueda.&quot;</span><span class="p">)</span>
                                        <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> 
                                                <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>

                                <span class="n">previous_mse</span> <span class="o">=</span> <span class="n">mse</span>

                                <span class="c1"># Guardar el mejor modelo si es necesario</span>
                                <span class="k">if</span> <span class="n">mse</span> <span class="o">&lt;</span> <span class="n">best_score</span><span class="p">:</span>
                                    <span class="n">best_score</span> <span class="o">=</span> <span class="n">mse</span>
                                    <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
                                    <span class="n">params_best_model</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;neurons&#39;</span><span class="p">:</span> <span class="n">neurons</span><span class="p">,</span>
                                        <span class="s1">&#39;batchsize&#39;</span><span class="p">:</span> <span class="n">batchsize</span><span class="p">,</span>
                                        <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="n">dropout_rate</span><span class="p">,</span>
                                        <span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="n">horizon</span><span class="p">,</span>
                                        <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
                                        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span>
                                    <span class="p">}</span>
                                    <span class="n">residuals_bestmodel</span> <span class="o">=</span> <span class="n">residuals</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">validation_metrics</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">,</span> <span class="n">train_metrics</span><span class="p">,</span> <span class="n">residual_hist</span><span class="p">,</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">params_best_model</span><span class="p">,</span> <span class="n">residuals_bestmodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="serie-price">
<h2>Serie Price<a class="headerlink" href="#serie-price" title="Link to this heading">#</a></h2>
<p>Utilización de las funciones para encontrar los mejores parametros para la serie de tiempo <code class="docutils literal notranslate"><span class="pre">Price</span></code></p>
<section id="modelo">
<h3>Modelo<a class="headerlink" href="#modelo" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>


<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="n">validation_metrics_price</span><span class="p">,</span><span class="n">test_metrics_price</span><span class="p">,</span><span class="n">train_metrics_price</span><span class="p">,</span><span class="n">residual_hist_price</span><span class="p">,</span><span class="n">best_model_price</span><span class="p">,</span><span class="n">params_best_model_price</span><span class="p">,</span><span class="n">residuals_bestmodel_price</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 928us/step
156/156 [==============================] - 0s 2ms/step
MSE: 16150293.288752208
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 901us/step
156/156 [==============================] - 0s 955us/step
156/156 [==============================] - 0s 896us/step
MSE: 152902789.46397722
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 945us/step
156/156 [==============================] - 0s 933us/step
156/156 [==============================] - 0s 1ms/step
MSE: 170010161.43417245
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 447167548.14901966
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 714us/step
MSE: 12064824.314732471
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 202960356.51002866
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 175507682.91952604
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 427243178.7913989
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 67794328.74731958
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 213793304.20071143
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 167526885.0350125
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 997us/step
156/156 [==============================] - 0s 1ms/step
MSE: 382664658.7977022
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 187056357.85266596
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 978us/step
156/156 [==============================] - 0s 1ms/step
MSE: 283335178.420215
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 387242960.12884724
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 960803203.5493392
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 28279969.986356933
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 59078153.87628244
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 343031157.86861295
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 418981328.29032516
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 972us/step
155/155 [==============================] - 0s 900us/step
MSE: 81133663.95697555
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 970us/step
155/155 [==============================] - 0s 934us/step
MSE: 71730711.67177883
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 971us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 938us/step
MSE: 170474998.2991395
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 339912928.8019924
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 919us/step
155/155 [==============================] - 0s 995us/step
MSE: 143178345.75753567
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 991us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 214921517.28180736
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 874us/step
155/155 [==============================] - 0s 859us/step
155/155 [==============================] - 0s 873us/step
MSE: 365391057.6290752
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 875us/step
155/155 [==============================] - 0s 899us/step
MSE: 294775752.63319504
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 261212977.0140209
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 330946656.7435246
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 530893909.3006677
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 974us/step
155/155 [==============================] - 0s 858us/step
155/155 [==============================] - 0s 2ms/step
MSE: 312166230.4065871
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 943us/step
154/154 [==============================] - 0s 986us/step
MSE: 15465794.720698908
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 933us/step
154/154 [==============================] - 0s 904us/step
154/154 [==============================] - 0s 930us/step
MSE: 38620298.23108064
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 929us/step
154/154 [==============================] - 0s 862us/step
154/154 [==============================] - 0s 921us/step
MSE: 337194222.5565518
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 322454824.03379977
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 53764761.85492292
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 870us/step
154/154 [==============================] - 0s 954us/step
MSE: 150871851.28311136
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 221793209.12200138
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 411805120.03242826
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 873us/step
154/154 [==============================] - 0s 885us/step
MSE: 141879559.8077454
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 960us/step
154/154 [==============================] - 0s 818us/step
MSE: 171421420.41553777
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 940us/step
154/154 [==============================] - 0s 1ms/step
MSE: 251978176.20781004
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 252143704.69352537
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 811us/step
154/154 [==============================] - 0s 876us/step
154/154 [==============================] - 0s 911us/step
MSE: 274438145.5614641
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 890us/step
154/154 [==============================] - 0s 951us/step
154/154 [==============================] - 0s 878us/step
MSE: 312491825.13056844
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 993us/step
154/154 [==============================] - 0s 829us/step
154/154 [==============================] - 0s 833us/step
MSE: 349655250.2132549
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 882us/step
154/154 [==============================] - 0s 933us/step
MSE: 352241362.5322854
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 981us/step
153/153 [==============================] - 0s 947us/step
153/153 [==============================] - 0s 966us/step
MSE: 26531157.35499328
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 46870621.79672767
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 170848794.15165898
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 926us/step
153/153 [==============================] - 0s 1ms/step
MSE: 345967809.6970266
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 977us/step
153/153 [==============================] - 0s 884us/step
MSE: 38051890.571847275
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 964us/step
153/153 [==============================] - 0s 903us/step
MSE: 217335201.29617047
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 825us/step
153/153 [==============================] - 0s 937us/step
MSE: 285582117.3017882
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 921us/step
153/153 [==============================] - 0s 947us/step
153/153 [==============================] - 0s 941us/step
MSE: 296247661.0414751
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 895us/step
153/153 [==============================] - 0s 936us/step
MSE: 83826575.02560718
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 941us/step
153/153 [==============================] - 0s 898us/step
153/153 [==============================] - 0s 1ms/step
MSE: 202236151.3075648
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 974us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 995us/step
MSE: 291733914.6550109
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 780us/step
153/153 [==============================] - 0s 913us/step
MSE: 187972504.16242045
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 817us/step
153/153 [==============================] - 0s 991us/step
MSE: 197125262.02547163
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 858us/step
153/153 [==============================] - 0s 897us/step
MSE: 253081825.88773856
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 992us/step
153/153 [==============================] - 0s 895us/step
153/153 [==============================] - 0s 842us/step
MSE: 337892028.76940197
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 903us/step
153/153 [==============================] - 0s 1ms/step
MSE: 356644815.18935764
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 979us/step
156/156 [==============================] - 0s 968us/step
156/156 [==============================] - 0s 1ms/step
MSE: 3010547.7197117135
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 931us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 3161940.9665041645
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 980us/step
156/156 [==============================] - 0s 853us/step
MSE: 3149236.3917477513
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 856us/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 941us/step
MSE: 33519601.539466918
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 3607839.540940001
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 978us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 917us/step
MSE: 3759686.1947458186
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 954us/step
MSE: 3886779.3994210353
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 68959530.68620446
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 967us/step
156/156 [==============================] - 0s 933us/step
156/156 [==============================] - 0s 956us/step
MSE: 6706164.696014428
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 994us/step
156/156 [==============================] - 0s 941us/step
156/156 [==============================] - 0s 992us/step
MSE: 5772418.377256627
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 986us/step
156/156 [==============================] - 0s 947us/step
MSE: 7690477.787872555
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 930us/step
156/156 [==============================] - 0s 923us/step
156/156 [==============================] - 0s 891us/step
MSE: 35970855.852351174
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 973us/step
156/156 [==============================] - 0s 844us/step
156/156 [==============================] - 0s 920us/step
MSE: 14483352.271298354
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 18980049.74803386
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 932us/step
MSE: 20711995.327011798
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 880us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 61734993.0159938
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 918us/step
155/155 [==============================] - 0s 916us/step
MSE: 6055161.208080229
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 964us/step
155/155 [==============================] - 0s 989us/step
155/155 [==============================] - 0s 1ms/step
MSE: 6383955.072101973
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 892us/step
MSE: 5770598.3315756265
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 979us/step
155/155 [==============================] - 0s 962us/step
MSE: 6967900.856153506
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 875us/step
155/155 [==============================] - 0s 1ms/step
MSE: 6533027.576765248
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 935us/step
155/155 [==============================] - 0s 983us/step
155/155 [==============================] - 0s 995us/step
MSE: 7888067.108994691
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 9737114.641543021
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 967us/step
155/155 [==============================] - 0s 956us/step
MSE: 28781848.108013894
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 947us/step
MSE: 13584886.520842675
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 7587619.247201048
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 17591176.557893425
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 975us/step
155/155 [==============================] - 0s 776us/step
155/155 [==============================] - 0s 892us/step
MSE: 24137223.193508346
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 28318060.04461556
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 974us/step
155/155 [==============================] - 0s 1ms/step
MSE: 23367432.228639632
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 980us/step
155/155 [==============================] - 0s 997us/step
155/155 [==============================] - 0s 1ms/step
MSE: 47120176.39089672
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 958us/step
MSE: 47164002.309108295
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 7380734.658722244
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 856us/step
154/154 [==============================] - 0s 1ms/step
MSE: 8666774.992888574
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 897us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 9296237.756169433
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 874us/step
154/154 [==============================] - 0s 1ms/step
MSE: 20184030.667412214
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 934us/step
154/154 [==============================] - 0s 1ms/step
MSE: 9606748.616271805
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 10588701.752642212
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 985us/step
MSE: 10529981.216761013
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 894us/step
154/154 [==============================] - 0s 867us/step
154/154 [==============================] - 0s 1ms/step
MSE: 27061645.04049156
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 911us/step
154/154 [==============================] - 0s 953us/step
MSE: 8642413.604792697
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 939us/step
MSE: 12047444.889279991
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 861us/step
154/154 [==============================] - 0s 856us/step
MSE: 16617986.727196446
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 981us/step
154/154 [==============================] - 0s 929us/step
MSE: 32270715.977603786
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 21058274.6106801
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 858us/step
154/154 [==============================] - 0s 959us/step
MSE: 45075172.40254757
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 52034548.93089727
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 981us/step
154/154 [==============================] - 0s 1ms/step
MSE: 108961835.88484451
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 996us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 8763471.79504807
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 968us/step
153/153 [==============================] - 0s 982us/step
MSE: 11826640.971032951
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 973us/step
153/153 [==============================] - 0s 1ms/step
MSE: 12939571.953838196
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 888us/step
MSE: 13534400.08074482
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 936us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 9158387.736078281
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 923us/step
153/153 [==============================] - 0s 907us/step
MSE: 13998144.433650086
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 879us/step
MSE: 14992998.19230638
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 926us/step
153/153 [==============================] - 0s 1ms/step
MSE: 13440801.531130457
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 987us/step
MSE: 10078731.692313934
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 917us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 991us/step
MSE: 16322901.686704356
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 22918530.43306046
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 48911062.03281533
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 959us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 888us/step
MSE: 26472060.47331562
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 34001925.7098891
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 961us/step
153/153 [==============================] - 0s 1ms/step
MSE: 61816533.254222676
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 108462921.82510772
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 965us/step
156/156 [==============================] - 0s 1ms/step
MSE: 3156822.10050529
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2809315.639094223
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2806232.2380542373
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 4732689.700457742
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2754228.312462983
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2963177.347902711
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2661318.511471515
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 4831047.557445279
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 4203250.271437263
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2765327.7672621235
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2861552.4822491514
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 6685963.5995947
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 4082316.348712838
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 2971547.6238788143
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 3067479.659678639
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 993us/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 838us/step
MSE: 9474761.208979888
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 4953688.545684926
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 5356182.790848902
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 928us/step
MSE: 5495188.352520271
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 924us/step
155/155 [==============================] - 0s 1ms/step
MSE: 7332414.770293677
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 4860832.605942214
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 5332121.377231344
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 5438649.242347611
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 6291269.956205464
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 5099605.963851617
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 973us/step
MSE: 5554373.354828199
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 939us/step
155/155 [==============================] - 0s 1ms/step
MSE: 5768025.989748453
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 6590435.27717829
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 927us/step
155/155 [==============================] - 0s 947us/step
MSE: 10857976.789829614
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 5154653.3602201445
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 5628042.297573273
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 953us/step
155/155 [==============================] - 0s 1ms/step
MSE: 6131069.6059918115
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 6647770.3865399845
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 6917434.322110934
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 7776262.8005062565
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8618366.946142867
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 7372494.547869732
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8038517.614949925
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8933608.431310073
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 9063596.518868605
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 6865407.134706102
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8301357.922515238
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8227002.664634502
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8577602.679094905
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 11012376.619914608
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 14912961.188717306
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 7798486.842676632
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 8694307.874880059
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 8287581.124410163
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 9396811.985753017
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 10904213.0949551
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 11703974.16564167
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 8298985.406945814
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 8390726.506570863
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 9748646.951035481
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 10981088.261988884
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 8380578.480110367
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 9098561.312693937
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 10548130.210481768
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 12308801.25580647
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 13298809.894816684
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 11241060.118103996
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 3ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 14510778.716676492
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 14639582.573859153
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 3520465.553603782
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 2728420.7403046675
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 2799915.025457797
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 3161033.908747605
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 5040893.273708535
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 2633246.2263151007
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 2772677.9012990007
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 3122232.800191785
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 3730196.3475246676
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 2707747.9869978935
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 6ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 2970045.8086146554
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 6ms/step
MSE: 2827454.6940006553
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 6ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 4501755.634362788
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 2926953.8835128658
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 3029657.5669096005
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 2967836.5582625684
Fluctuación menor al 5% en el MSE por 2 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5437516.259667325
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 6107630.934030135
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5295500.923619136
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5559603.374960859
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 6ms/step
MSE: 5914815.156952196
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5064636.225571492
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5343883.563343527
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5743730.964235698
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 5634213.25258259
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 13757694.170457035
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 6048155.2439014325
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5691619.9588567475
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5840607.820550532
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 6159045.834491565
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 5531596.383557628
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 5803636.1414555395
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 7ms/step
MSE: 8398133.632793935
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 7005875.004186067
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 7605118.154813282
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 8412461.292112954
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 7ms/step
MSE: 7474942.10648538
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 6866043.9572822675
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 7658720.863817425
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 10369665.133450964
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 7979272.204834612
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 11611390.47338294
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 8157991.343164959
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 9929679.888000175
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 6ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 7676853.855431701
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 10869080.334576754
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 7583890.604734329
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 8132866.958081578
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 9684693.052224046
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 8189407.705480919
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 9605685.687934158
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 10514065.959595088
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 9525660.997755421
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 8138466.397466711
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 8ms/step
MSE: 8714274.64789972
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 13105527.824493123
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 8683823.86166181
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 20443373.71893812
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 9622994.723769842
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 10311329.447353384
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 9819608.67313705
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 10417985.434982335
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 10230888.15738796
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 11977093.944954408
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_price</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 10000, &#39;batchsize&#39;: 32, &#39;dropout_rate&#39;: 0.4, &#39;horizon&#39;: 7, &#39;window&#39;: 7, &#39;MSE&#39;: 2633246.2263151007}
</pre></div>
</div>
</div>
</div>
<p>A diferencia de las RNN redes neuronales recurrentes el modelo mpl es rápido por que permite hacer la optimización con todos los posibles parametros. los mejores resultados fueron con la combinación {‘neurons’: 10000, ‘batchsize’: 32, ‘dropout_rate’: 0.4, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 2633246.2263151007}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="residuales">
<h3>Residuales<a class="headerlink" href="#residuales" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo para su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_price</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.009691
1        2             0.009691
2        3             0.009691
3        4             0.009691
4        5             0.009691
5        6             0.009691
6        7             0.009691
7        8             0.009691
8        9             0.009691
9       10             0.009691
</pre></div>
</div>
<img alt="_images/fb43298746e2e8ac0c9548eba1c121d4d90f56bf7370e420b3f0952845c41522.png" src="_images/fb43298746e2e8ac0c9548eba1c121d4d90f56bf7370e420b3f0952845c41522.png" />
<img alt="_images/db2e5c3de61d572e365491bd311195bd9f3efdbd1cd00b4c0f1ac5ab187d5fae.png" src="_images/db2e5c3de61d572e365491bd311195bd9f3efdbd1cd00b4c0f1ac5ab187d5fae.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_13904\1560686776.py:34: MatplotlibDeprecationWarning:

The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
</pre></div>
</div>
<img alt="_images/d3ebaf9a89e3f15514aa7357172cc461eebeba533852b27d59c2fb45b1d05268.png" src="_images/d3ebaf9a89e3f15514aa7357172cc461eebeba533852b27d59c2fb45b1d05268.png" />
<img alt="_images/b62182a624fd02f9a4ea94cd20dad4ead2938be410f2bd2fa4001fb4028c059b.png" src="_images/b62182a624fd02f9a4ea94cd20dad4ead2938be410f2bd2fa4001fb4028c059b.png" />
<img alt="_images/19e198dc1520bf94a3823d787b6f5d821bfee9e02a3756e8c97bf882163b4dff.png" src="_images/19e198dc1520bf94a3823d787b6f5d821bfee9e02a3756e8c97bf882163b4dff.png" />
<img alt="_images/f2b8f5cb0c309eec87efd3a434eb74cda0db4038e243145993d4fd99b78f7b7d.png" src="_images/f2b8f5cb0c309eec87efd3a434eb74cda0db4038e243145993d4fd99b78f7b7d.png" />
<img alt="_images/dfe9f982fba9136461f42a3e1528ac15167fafb3bc2d0b969676c4f511dc01a7.png" src="_images/dfe9f982fba9136461f42a3e1528ac15167fafb3bc2d0b969676c4f511dc01a7.png" />
<img alt="_images/87ee17cccd54eb786d98cf4171ea4dcf19102e40eb193b762ebb9fd1d1b22bcc.png" src="_images/87ee17cccd54eb786d98cf4171ea4dcf19102e40eb193b762ebb9fd1d1b22bcc.png" />
<img alt="_images/0da097bb61df5717d4b14d429fa48e5099a645167596b02939b1c96978b49a11.png" src="_images/0da097bb61df5717d4b14d429fa48e5099a645167596b02939b1c96978b49a11.png" />
<img alt="_images/1bc43be3d997a23f6e37baa9fd473ec1698ebe38fbf8e641598fe6e6408f2db8.png" src="_images/1bc43be3d997a23f6e37baa9fd473ec1698ebe38fbf8e641598fe6e6408f2db8.png" />
<img alt="_images/90d3512780c14b42819d08ec76653703b7e3ac821d9186c17b4cecfe65fc2361.png" src="_images/90d3512780c14b42819d08ec76653703b7e3ac821d9186c17b4cecfe65fc2361.png" />
<img alt="_images/e271a38872df74279c417d090358968fc29f0787701c47e2879cef9e0410d1f4.png" src="_images/e271a38872df74279c417d090358968fc29f0787701c47e2879cef9e0410d1f4.png" />
<img alt="_images/c42d91059d86aeba35c9fa696386f6630ff0d485c1abb37d56de8303b2e5b0c4.png" src="_images/c42d91059d86aeba35c9fa696386f6630ff0d485c1abb37d56de8303b2e5b0c4.png" />
<img alt="_images/1b5abc358a7a36ed24a20a60eb89278b0dc3f977ae3539e3cf1267cc83462df1.png" src="_images/1b5abc358a7a36ed24a20a60eb89278b0dc3f977ae3539e3cf1267cc83462df1.png" />
<img alt="_images/0ac9f4e1fea6d8265349ffb69b67238c0e0b763c96887f1b31f446dbee1cbd10.png" src="_images/0ac9f4e1fea6d8265349ffb69b67238c0e0b763c96887f1b31f446dbee1cbd10.png" />
</div>
</div>
<p>De los residuales podemos secir que no cumplen cumplen, no distribuyen normal, tienen asimetria, además no son independientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_price</span>  <span class="c1"># Lista que contiene los diccionarios</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neurons</th>
      <th>batchsize</th>
      <th>Dropout</th>
      <th>horizon</th>
      <th>window</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>16</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>22.423832</td>
      <td>1861.957091</td>
      <td>1.615029e+07</td>
      <td>4018.742750</td>
      <td>0.934851</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>32</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>56.325140</td>
      <td>5989.779238</td>
      <td>1.529028e+08</td>
      <td>12365.386749</td>
      <td>0.379783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>64</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>61.189049</td>
      <td>6656.375663</td>
      <td>1.700102e+08</td>
      <td>13038.794478</td>
      <td>0.312953</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>128</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>93.005465</td>
      <td>10081.225903</td>
      <td>4.471675e+08</td>
      <td>21146.336518</td>
      <td>-0.806789</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>16</td>
      <td>0.4</td>
      <td>7</td>
      <td>7</td>
      <td>22.090840</td>
      <td>1706.686339</td>
      <td>1.206482e+07</td>
      <td>3473.445597</td>
      <td>0.951168</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>10000</td>
      <td>128</td>
      <td>0.6</td>
      <td>28</td>
      <td>28</td>
      <td>17.292759</td>
      <td>1444.880491</td>
      <td>1.031133e+07</td>
      <td>3211.125885</td>
      <td>0.956252</td>
    </tr>
    <tr>
      <th>252</th>
      <td>10000</td>
      <td>16</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>18.304647</td>
      <td>1394.751155</td>
      <td>9.819609e+06</td>
      <td>3133.625484</td>
      <td>0.958363</td>
    </tr>
    <tr>
      <th>253</th>
      <td>10000</td>
      <td>32</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>17.798366</td>
      <td>1459.718185</td>
      <td>1.041799e+07</td>
      <td>3227.690418</td>
      <td>0.955780</td>
    </tr>
    <tr>
      <th>254</th>
      <td>10000</td>
      <td>64</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>17.267777</td>
      <td>1447.850930</td>
      <td>1.023089e+07</td>
      <td>3198.575958</td>
      <td>0.956572</td>
    </tr>
    <tr>
      <th>255</th>
      <td>10000</td>
      <td>128</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>18.056351</td>
      <td>1567.440067</td>
      <td>1.197709e+07</td>
      <td>3460.793832</td>
      <td>0.949184</td>
    </tr>
  </tbody>
</table>
<p>256 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En esta figura podemos observar el MSE a lo largo de las iteraciones, vemos que a medida que se aumnetaron las neuronas el resultado mejoraba. Además delemitar la busqueda a partir de los parametros que ya se sabía que tenian buen desempeño permitió estabilizar la metrica.</p>
</section>
<section id="boxplot">
<h4>Boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h4>
<p>Ahora compararemos los errores en el entrenamiento, prueba y test con la metrica mape porque esta representa los errores de manera porcentual</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_price</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_price</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
        
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre 3 Listas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a103bb2727cdf6ee3ec6629ef04a2d838062cdeb57c31e9afe8dd2b0158565b.png" src="_images/7a103bb2727cdf6ee3ec6629ef04a2d838062cdeb57c31e9afe8dd2b0158565b.png" />
</div>
</div>
<p>Las medianas son similares al igual que los las cajas porque al manejar la metodología de ventanas deslizantes los conjuntos son iguales a excepción de la primera y ultima ventana. sin embargo las medianas se van reduciendo porque el modelo aprende luego de evaluar el conjunto de validación, reajuste del modelo.</p>
<p>Los puntos por fuera de las cajas implican que el modelo suavizó picos o fluctuaciones atípicas</p>
</section>
</section>
<section id="prediciones">
<h3>Prediciones<a class="headerlink" href="#prediciones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_price</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 1s 6ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 5ms/step
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">val_pred</span><span class="p">)</span>

<span class="n">datos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">datos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Fila </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Fila&quot;</span><span class="p">,</span> 
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Filas del Array con Ventanas Superpuestas&quot;</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Aquí podemos ver la predicción de las ventanas para entrenamiento de manera independiente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>En la grafica se puede los horizones de predicción para cada ventana. el conjunto de train es igual al de validación sin embargo la prueba se mantiene con diferencia</p>
</section>
</section>
<section id="serie-change">
<h2>Serie Change%<a class="headerlink" href="#serie-change" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Crear el objeto escalador</span>

<span class="n">datos</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Change %&#39;</span><span class="p">]</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Escala los datos</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Para esta serie se hizo una modificación especial, no solo se esscalaron los datos sino que se les sumó 1 para evitar tener errores por valores en 0, a la hora de calcular las métricas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windows</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">dropout_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">batchsizes</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span>
<span class="n">neurons_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

<span class="n">validation_metrics_ch</span><span class="p">,</span><span class="n">test_metrics_ch</span><span class="p">,</span><span class="n">train_metrics_ch</span><span class="p">,</span><span class="n">residual_hist_ch</span><span class="p">,</span><span class="n">best_model_ch</span><span class="p">,</span><span class="n">params_best_model_ch</span><span class="p">,</span><span class="n">residuals_bestmodel_ch</span><span class="o">=</span><span class="n">busqueda</span> <span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">windows</span><span class="p">,</span><span class="n">horizons</span><span class="p">,</span><span class="n">dropout_rates</span><span class="p">,</span><span class="n">batchsizes</span><span class="p">,</span><span class="n">neurons_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.05909333935263944
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.2603373231986953
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 3ms/step
MSE: 1.585581443658808
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 732us/step
156/156 [==============================] - 0s 750us/step
MSE: 2.694763131293776
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 897us/step
156/156 [==============================] - 0s 789us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.11707063148044801
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.18169854365926572
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 809us/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 876us/step
MSE: 1.4094751999069142
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 713us/step
156/156 [==============================] - 0s 909us/step
MSE: 1.0748297423357818
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.3557188360662237
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.16415542811893377
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.48910141179130967
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 2.2698201553007777
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.5858055767394375
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.9277551401435231
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.9296184741353771
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 1.1588583502262892
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.14562896076384765
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.20575152729131863
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8889067829101013
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.134874881366996
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.06641258880683314
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.4774838644393618
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8425464859420897
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.9294105397158471
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.23459046406210698
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8299700210332155
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.7792468059543686
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.0051601178090948
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.5196609545241472
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 746us/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.8045533632829479
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.1014093036196981
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 1.0365338758644698
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.020475501242033886
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.5570772186906672
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.4882667506099902
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.756367356412222
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.23821268290252512
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.2954332170241732
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.43658367224832034
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.4335227890149538
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.28720976103821105
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.5749819040116433
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.8402441818368778
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.065603378993418
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.4321762736247414
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.6165282940222847
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.837118419459125
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 1.1335659716110567
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.06058725275347169
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 749us/step
MSE: 0.1280621877360646
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 681us/step
153/153 [==============================] - 0s 514us/step
153/153 [==============================] - 0s 521us/step
MSE: 0.47272553867208067
Entrenando modelo con 10 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 877us/step
153/153 [==============================] - 0s 538us/step
153/153 [==============================] - 0s 594us/step
MSE: 1.1987120574732686
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 769us/step
153/153 [==============================] - 0s 604us/step
153/153 [==============================] - 0s 904us/step
MSE: 0.03599137912537855
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 562us/step
153/153 [==============================] - 0s 696us/step
153/153 [==============================] - 0s 616us/step
MSE: 0.16845616613133013
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 708us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 695us/step
MSE: 0.6944793691431422
Entrenando modelo con 10 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 712us/step
153/153 [==============================] - 0s 872us/step
153/153 [==============================] - 0s 916us/step
MSE: 1.0876476253552478
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 733us/step
153/153 [==============================] - 0s 805us/step
153/153 [==============================] - 0s 555us/step
MSE: 0.3545260101881773
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.5843964842890695
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 520us/step
153/153 [==============================] - 0s 518us/step
153/153 [==============================] - 0s 520us/step
MSE: 0.7051448479254782
Entrenando modelo con 10 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 435us/step
153/153 [==============================] - 0s 651us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.9340359174246949
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 517us/step
153/153 [==============================] - 0s 522us/step
MSE: 0.4203256566766652
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 539us/step
153/153 [==============================] - 0s 535us/step
153/153 [==============================] - 0s 543us/step
MSE: 0.88684618463601
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 561us/step
153/153 [==============================] - 0s 536us/step
153/153 [==============================] - 0s 556us/step
MSE: 0.9504739088165374
Entrenando modelo con 10 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 530us/step
153/153 [==============================] - 0s 515us/step
153/153 [==============================] - 0s 540us/step
MSE: 1.13661710733869
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 560us/step
156/156 [==============================] - 0s 874us/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0008149540587435323
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0005950647201244154
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.001302999286123678
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.01447780438915251
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0014771066077113864
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 3ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.005051116766987247
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0038161086126692312
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.010669408940149231
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.0026844096321119843
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 916us/step
156/156 [==============================] - 0s 949us/step
MSE: 0.014955870571627644
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.014259012124758283
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.012810075375399322
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.03642754675877936
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.04422030229844902
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.09635294106866474
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.395979049566752
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 955us/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.000603416143070798
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0010948853760779672
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0034553619895939377
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.003925842455439333
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.005418839472955081
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.005807255728955918
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.014578707945828565
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.01748402033871611
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 739us/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.00922264983174165
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.015271885249447734
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.04232051665807563
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.05405560537981136
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.028414007666050217
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.07439274091311719
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.12030871123497908
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.202470073006523
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0018437631135278317
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 965us/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0022412706096054916
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 752us/step
154/154 [==============================] - 0s 763us/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.00430965652414995
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.028091829259529917
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.002929374989313192
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.005329248754607484
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.011474805165610296
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 981us/step
154/154 [==============================] - 0s 798us/step
MSE: 0.015834333218971163
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 987us/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.01424876468888499
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 816us/step
MSE: 0.018786137655609863
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.04568823972387753
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0890146786555277
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.023407950519256232
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.09185527319957458
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.16834724589319983
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.3689010857619136
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 890us/step
153/153 [==============================] - 0s 719us/step
MSE: 0.002751284590271814
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0017061094108474235
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0030689954584778513
Entrenando modelo con 100 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.009761910208594895
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.0027492990529228204
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 657us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.006391718254742972
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 746us/step
MSE: 0.015546035526448157
Entrenando modelo con 100 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 490us/step
153/153 [==============================] - 0s 514us/step
153/153 [==============================] - 0s 619us/step
MSE: 0.03742347536073782
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 824us/step
153/153 [==============================] - 0s 596us/step
153/153 [==============================] - 0s 586us/step
MSE: 0.005086496657134215
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 827us/step
153/153 [==============================] - 0s 518us/step
153/153 [==============================] - 0s 834us/step
MSE: 0.022089037449350226
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 726us/step
153/153 [==============================] - 0s 732us/step
153/153 [==============================] - 0s 731us/step
MSE: 0.05814359964685127
Entrenando modelo con 100 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 625us/step
153/153 [==============================] - 0s 710us/step
153/153 [==============================] - 0s 627us/step
MSE: 0.10037668338037349
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 973us/step
153/153 [==============================] - 0s 619us/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.04103788709356959
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 519us/step
153/153 [==============================] - 0s 987us/step
153/153 [==============================] - 0s 758us/step
MSE: 0.06954406535247447
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 619us/step
153/153 [==============================] - 0s 513us/step
153/153 [==============================] - 0s 622us/step
MSE: 0.1675724684043114
Entrenando modelo con 100 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 837us/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 728us/step
MSE: 0.2872479591026975
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0006305667861343768
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005860999245378207
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005696227415473295
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.004530010229346606
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00040908610882465314
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005564332782344192
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0004811647088058412
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 1ms/step
MSE: 0.004855645529780191
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0006047629459960263
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00043026142355265067
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.00048249996527327435
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.005580763071722782
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.004760998706987854
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0025421914705675156
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 1ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.0005936739859838157
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
156/156 [==============================] - 0s 2ms/step
MSE: 0.014402357321590977
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 863us/step
155/155 [==============================] - 0s 991us/step
MSE: 0.0005817072185295231
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0004937463066879164
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.00044282283249658615
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 964us/step
MSE: 0.0032473460669705098
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0012163975095008995
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 3ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0010333525735375401
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0005261728545994399
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 819us/step
MSE: 0.003696783165971693
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.00041142009566595526
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.0005089093951831345
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 959us/step
MSE: 0.0012458478307928126
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 1ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0021329132832305737
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 0s 1ms/step
MSE: 0.000748449524192817
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 0s 645us/step
155/155 [==============================] - 0s 818us/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.000832343802311448
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.003985209370276998
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
155/155 [==============================] - 0s 2ms/step
MSE: 0.0021484611368109284
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005588286385860701
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005099567065679157
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0005234638583973784
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 3ms/step
154/154 [==============================] - 1s 3ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0036816672166264212
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0014198637337889657
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 3ms/step
MSE: 0.0005858281468757587
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0006908594842930826
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0020011213417978
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0005201668521378033
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0007530737237727457
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0009982917847477484
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0011989854855535879
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0009727966657284218
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.0012199221520393657
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 1ms/step
MSE: 0.0018389753755645934
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 0s 1ms/step
154/154 [==============================] - 0s 2ms/step
154/154 [==============================] - 0s 2ms/step
MSE: 0.006393428835348022
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.000701624886544609
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0004987736561434299
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0005061459783041607
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.003897810723216911
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 3ms/step
MSE: 0.0010055153985089173
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.001021447942112288
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0008227292597228723
Entrenando modelo con 1000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.004533845316596562
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0008468969494590475
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0016091862660989693
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0036446327483641893
Entrenando modelo con 1000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.007364902540837856
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
MSE: 0.002733067729610185
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0007355484163858131
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.0014994853568367713
Entrenando modelo con 1000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 0s 1ms/step
153/153 [==============================] - 0s 2ms/step
153/153 [==============================] - 0s 2ms/step
MSE: 0.011954527430312445
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0007573890768965194
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00041850456496750343
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00036826683431922077
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.001157957460067669
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00043731816202246523
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00038134200338956723
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.00041280297554316094
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0013569057296025262
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0009053758008410619
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0005035220553292795
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0004759535046763773
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.001583823241089873
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 3ms/step
MSE: 0.0019690534609987397
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 5ms/step
MSE: 0.0006956003280096363
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.00047990112057633226
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 7, window 7
156/156 [==============================] - 1s 3ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
MSE: 0.0005284445150715303
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0004275805584862488
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 3ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003771401907635318
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00038254844948481327
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0008675351525780169
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0006833534021959823
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.00047300162289451816
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0003987081400217102
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
MSE: 0.0008161562346266465
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0007466526176314567
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 6ms/step
MSE: 0.0005813870237274661
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.000507905806912303
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0014005702562881939
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0005244703878228604
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 14, window 14
155/155 [==============================] - 1s 5ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0006375122281961955
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0004701969076149264
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 14, window 14
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 4ms/step
155/155 [==============================] - 1s 5ms/step
MSE: 0.0010445468528638407
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004936620476859692
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 0.000400488248600201
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0003843512267153489
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0032853986594356915
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0006489105436979922
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0005666743703820801
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00043059487534783677
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.003419553670142277
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.0006298715066630178
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004721515143130168
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0004707812546811508
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 6ms/step
MSE: 0.004743911302144779
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0022460897073498074
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00043261384662724947
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 4ms/step
MSE: 0.00044883248126937854
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 21, window 21
154/154 [==============================] - 1s 4ms/step
154/154 [==============================] - 1s 5ms/step
154/154 [==============================] - 1s 5ms/step
MSE: 0.0038225561407594848
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0004211485735100257
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0003869893469859229
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0003986801950501384
Fluctuación menor al 5% en el MSE por 1 iteración(es).
Entrenando modelo con 10000 neuronas, dropout 0.2, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0008473948937455369
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.002751524354216895
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
MSE: 0.0005916540776832036
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.00043575577174560857
Entrenando modelo con 10000 neuronas, dropout 0.4, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0012505119356782655
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0037812866589783255
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0007117148854117376
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0005002867473626199
Entrenando modelo con 10000 neuronas, dropout 0.6, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0011742146739582744
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 16, horizon 28, window 28
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.007636879226682763
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 32, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.003560590891819835
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 64, horizon 28, window 28
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 6ms/step
153/153 [==============================] - 1s 6ms/step
MSE: 0.0008218893843505753
Entrenando modelo con 10000 neuronas, dropout 0.8, batch size 128, horizon 28, window 28
153/153 [==============================] - 1s 4ms/step
153/153 [==============================] - 1s 5ms/step
153/153 [==============================] - 1s 5ms/step
MSE: 0.0005851265808891014
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params_best_model_ch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;neurons&#39;: 10000, &#39;batchsize&#39;: 64, &#39;dropout_rate&#39;: 0.2, &#39;horizon&#39;: 7, &#39;window&#39;: 7, &#39;MSE&#39;: 0.00036826683431922077}
</pre></div>
</div>
</div>
</div>
<p>Los mejores parametros para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> fueron:
{‘neurons’: 10000, ‘batchsize’: 64, ‘dropout_rate’: 0.2, ‘horizon’: 7, ‘window’: 7, ‘MSE’: 0.00036826683431922077}. De las series analizadas podemos decir que 10000 neuronas y ventanas de 7 valores entregan mejores resultados</p>
<section id="id1">
<h3>Residuales<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>tomamos los residuos del mejor modelo  para la serie <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">%</span></code> su evaluación y analisamos los residuales de cada ventana, además se mostraran las graficas para 5 ventanas aleatorias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">residuals_bestmodel_ch</span>


<span class="n">ljung_box_pvalues</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ljung_box_pvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ljung_box_pvalue</span><span class="p">)</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ventana&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;LJung-Box (p-value)&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalues</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_resultados</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Seleccionar una muestra aleatoria de 5 ventanas para graficar</span>
<span class="n">muestras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">muestras</span><span class="p">:</span>
    <span class="n">ventana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Serie de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">qqplot</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;QQPlot - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
    <span class="n">acf_vals</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">ventana</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ventana</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_vals</span><span class="p">)),</span> <span class="n">acf_vals</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ACF de Residuos - Ventana </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelación&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Ventana  LJung-Box (p-value)
0        1             0.460332
1        2             0.460332
2        3             0.460332
3        4             0.460332
4        5             0.460332
5        6             0.460332
6        7             0.460332
7        8             0.460332
8        9             0.460332
9       10             0.460332
</pre></div>
</div>
<img alt="_images/9034b80de9a5adbed3ef8909663b8aac1ee41d04503ce3fb3f754253d5413415.png" src="_images/9034b80de9a5adbed3ef8909663b8aac1ee41d04503ce3fb3f754253d5413415.png" />
<img alt="_images/893714ce63a6620adefa1f8f0fe3baf670aa71fa51fa7d55238df218710c3b98.png" src="_images/893714ce63a6620adefa1f8f0fe3baf670aa71fa51fa7d55238df218710c3b98.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\claud\AppData\Local\Temp\ipykernel_24768\3775612513.py:37: MatplotlibDeprecationWarning: The &#39;use_line_collection&#39; parameter of stem() was deprecated in Matplotlib 3.6 and will be removed two minor releases later. If any parameter follows &#39;use_line_collection&#39;, they should be passed as keyword, not positionally.
  plt.stem(range(len(acf_vals)), acf_vals, use_line_collection=True)
</pre></div>
</div>
<img alt="_images/5503e46c423940d0cd40f13808b12cc9878e658d0d360b9f67893d57d407cf75.png" src="_images/5503e46c423940d0cd40f13808b12cc9878e658d0d360b9f67893d57d407cf75.png" />
<img alt="_images/a6398deb84d0130852d20da7589bcb37a6c636c8159e2c18fd88c3be12366c1c.png" src="_images/a6398deb84d0130852d20da7589bcb37a6c636c8159e2c18fd88c3be12366c1c.png" />
<img alt="_images/b32ffab6e691fe930e2909c613a8d85982a1826338fa961e39486e896b07b64e.png" src="_images/b32ffab6e691fe930e2909c613a8d85982a1826338fa961e39486e896b07b64e.png" />
<img alt="_images/eca1b7a0da55b3bc09e92d2df84ffb4e82bcc8f36b28167cf856c3dfe3f7531c.png" src="_images/eca1b7a0da55b3bc09e92d2df84ffb4e82bcc8f36b28167cf856c3dfe3f7531c.png" />
<img alt="_images/3d1c312ec0d8f689111bcf66efda142f7d4eb730a97b9c2205acf2e62ba2f2d8.png" src="_images/3d1c312ec0d8f689111bcf66efda142f7d4eb730a97b9c2205acf2e62ba2f2d8.png" />
<img alt="_images/23abe14fd0a6dc184ad47b791bfc45c3ebc5faa9e46dc44aee4ab8025959a36f.png" src="_images/23abe14fd0a6dc184ad47b791bfc45c3ebc5faa9e46dc44aee4ab8025959a36f.png" />
<img alt="_images/97aafa1fb3664ff0f8acef9c734765ebc04f0340a85d06a05ca7b875c6d888e6.png" src="_images/97aafa1fb3664ff0f8acef9c734765ebc04f0340a85d06a05ca7b875c6d888e6.png" />
<img alt="_images/e78f96952d471a18bc6d1e4057338ac8994290e62c5c8ab9ec236e7964b6fdc9.png" src="_images/e78f96952d471a18bc6d1e4057338ac8994290e62c5c8ab9ec236e7964b6fdc9.png" />
<img alt="_images/c7b9793c9505f966e715527791169b4fccecb8af8e50344f7cf1c9062f148b5f.png" src="_images/c7b9793c9505f966e715527791169b4fccecb8af8e50344f7cf1c9062f148b5f.png" />
<img alt="_images/435ca42f3b52ed8ddb1890c344d117c7c3f230fb68b35a6a3c6cbc0e69a39fda.png" src="_images/435ca42f3b52ed8ddb1890c344d117c7c3f230fb68b35a6a3c6cbc0e69a39fda.png" />
<img alt="_images/777d1b0d2149156b8edd4e1fc0cc93f6efcb868b456cfb2691642b98961249dc.png" src="_images/777d1b0d2149156b8edd4e1fc0cc93f6efcb868b456cfb2691642b98961249dc.png" />
<img alt="_images/1c556819c2f25b3fd5672cce1842ac1a5a92ba7fcaad33b5a12c9ff95664680d.png" src="_images/1c556819c2f25b3fd5672cce1842ac1a5a92ba7fcaad33b5a12c9ff95664680d.png" />
<img alt="_images/cb56bb37860fd2718128fa8aa8046aa2d5a6d23c0858ae75bbbe32e252637c06.png" src="_images/cb56bb37860fd2718128fa8aa8046aa2d5a6d23c0858ae75bbbe32e252637c06.png" />
</div>
</div>
<p>Los residuales no cumplen con los supuestos al igual que en la serie price eso puede deberse al sobre ajuste del modelo</p>
<section id="id2">
<h4>Tabla de todos los modelos, sus parametros y sus metricas<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">validation_metrics_ch</span>  
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
        <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricasval</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">metricasval</span> <span class="o">=</span> <span class="n">metricasval</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">metricasval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neurons</th>
      <th>batchsize</th>
      <th>Dropout</th>
      <th>horizon</th>
      <th>window</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>16</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>15.617120</td>
      <td>0.179193</td>
      <td>0.059093</td>
      <td>0.243091</td>
      <td>-180.511995</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>32</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>37.880822</td>
      <td>0.434304</td>
      <td>0.260337</td>
      <td>0.510233</td>
      <td>-798.659770</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>64</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>96.673118</td>
      <td>1.108118</td>
      <td>1.585581</td>
      <td>1.259199</td>
      <td>-4869.996929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>128</td>
      <td>0.2</td>
      <td>7</td>
      <td>7</td>
      <td>109.988278</td>
      <td>1.260652</td>
      <td>2.694763</td>
      <td>1.641573</td>
      <td>-8276.692689</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>16</td>
      <td>0.4</td>
      <td>7</td>
      <td>7</td>
      <td>28.624058</td>
      <td>0.328263</td>
      <td>0.117071</td>
      <td>0.342156</td>
      <td>-358.632929</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>251</th>
      <td>10000</td>
      <td>128</td>
      <td>0.6</td>
      <td>28</td>
      <td>28</td>
      <td>2.328856</td>
      <td>0.026710</td>
      <td>0.001174</td>
      <td>0.034267</td>
      <td>-2.551069</td>
    </tr>
    <tr>
      <th>252</th>
      <td>10000</td>
      <td>16</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>7.396625</td>
      <td>0.084988</td>
      <td>0.007637</td>
      <td>0.087389</td>
      <td>-22.094984</td>
    </tr>
    <tr>
      <th>253</th>
      <td>10000</td>
      <td>32</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>4.850389</td>
      <td>0.055796</td>
      <td>0.003561</td>
      <td>0.059671</td>
      <td>-9.767633</td>
    </tr>
    <tr>
      <th>254</th>
      <td>10000</td>
      <td>64</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>1.837308</td>
      <td>0.021211</td>
      <td>0.000822</td>
      <td>0.028669</td>
      <td>-1.485493</td>
    </tr>
    <tr>
      <th>255</th>
      <td>10000</td>
      <td>128</td>
      <td>0.8</td>
      <td>28</td>
      <td>28</td>
      <td>1.413651</td>
      <td>0.016301</td>
      <td>0.000585</td>
      <td>0.024189</td>
      <td>-0.769486</td>
    </tr>
  </tbody>
</table>
<p>256 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">metricasval</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MSE vs Índice&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Índice&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="s1">&#39;MSE&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>De la grafica de MSE vs la iteración del modelo podemos ver que a medida que se aumentan las neuronas ( que fueron el búcle más grande) el modelo tiene mejores metricas pero esto también puede implicar sobre ajuste del modelo</p>
</section>
<section id="id3">
<h4>Boxplot<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics_list</span> <span class="o">=</span> <span class="n">train_metrics_ch</span>  
<span class="n">metricas_train</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
        
    <span class="n">metricas_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_train</span><span class="p">)</span>
<span class="n">metricas_train</span> <span class="o">=</span> <span class="n">metricas_train</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">metrics_list</span> <span class="o">=</span> <span class="n">test_metrics_ch</span>

<span class="n">metricas_test</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_list</span><span class="p">:</span>
    
    <span class="n">metricas_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">metricas_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas_test</span><span class="p">)</span>
<span class="n">metricas_test</span> <span class="o">=</span> <span class="n">metricas_test</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_train</span> <span class="o">=</span>  <span class="n">metricas_train</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_val</span><span class="o">=</span>   <span class="n">metricasval</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>
<span class="n">errores_test</span> <span class="o">=</span>  <span class="n">metricas_test</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span>

<span class="c1"># Crear una lista que contenga todas las listas de residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="p">[</span><span class="n">errores_train</span><span class="p">,</span> <span class="n">errores_val</span><span class="p">,</span> <span class="n">errores_test</span><span class="p">]</span>

<span class="c1"># Crear el Boxplot usando Seaborn</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuos</span><span class="p">)</span>

<span class="c1"># Personalizar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Residuos entre train, test, validation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lista&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MAPE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Residuos train&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos val&#39;</span><span class="p">,</span> <span class="s1">&#39;Residuos test&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" src="_images/24b05918c7e7d1e6925f873fda8df5257b5bffd62326428fbf4c28e9577aaaeb.png" />
</div>
</div>
<p>La medianas se ven similares, incluso se logra ver que las casjas son iguales. Por lo que se puede afirmar que el modelo tuvo un comportamiento constante. como los puntos por fuera de las cajas son similares señala que los datos eran atípicos y no son un error del modelo.</p>
</section>
</section>
<section id="id4">
<h3>Prediciones<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejormodelo</span><span class="o">=</span><span class="n">best_model_ch</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="o">=</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">train</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">val</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">mejormodelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>156/156 [==============================] - 1s 5ms/step
156/156 [==============================] - 1s 4ms/step
156/156 [==============================] - 1s 4ms/step
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
        
<span class="n">val_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="o">+</span> <span class="n">j</span><span class="p">,</span> 
            <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">})</span>

<span class="c1"># Preparar los datos para la lista &#39;datos&#39;</span>
<span class="n">datos_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datos</span><span class="p">):</span>
    <span class="n">datos_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="s2">&quot;Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Fila&quot;</span><span class="p">:</span> <span class="s2">&quot;Serie Datos&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Índice&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  
        <span class="s2">&quot;Valor&quot;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">})</span>

<span class="c1"># Combinar ambos conjuntos de datos en un DataFrame</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span> <span class="o">+</span> <span class="n">datos_data</span><span class="o">+</span><span class="n">val_data</span><span class="o">+</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Crear el gráfico con Plotly Express</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Índice&quot;</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">,</span>  <span class="c1"># Diferenciar &#39;Train&#39; y &#39;Datos&#39;</span>
      <span class="c1"># Mantener la separación por filas</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gráfico de Train y Lista Datos&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Como se ve en la gráfica el modelo es capaz de identificar las tendencias y la serie en general a excepción de los picos abrutos.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos">Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones">Funciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ventanas-deslizantes">Ventanas deslizantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo">Construcción del Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas">Métricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-optimizacion">Función de optimización</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-price">Serie Price</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-todos-los-modelos-sus-parametros-y-sus-metricas">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediciones">Prediciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#serie-change">Serie Change%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Residuales</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Tabla de todos los modelos, sus parametros y sus metricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Boxplot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Prediciones</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johana y Claudia
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>